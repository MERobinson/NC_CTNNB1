<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section2 Ikaros KO/Bcat GOF DE | NC CTNNB1 project - Nehir Cosgun</title>
  <meta name="description" content="Section2 Ikaros KO/Bcat GOF DE | NC CTNNB1 project - Nehir Cosgun" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Section2 Ikaros KO/Bcat GOF DE | NC CTNNB1 project - Nehir Cosgun" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section2 Ikaros KO/Bcat GOF DE | NC CTNNB1 project - Nehir Cosgun" />
  
  
  

<meta name="author" content="Mark Robinson" />


<meta name="date" content="2021-03-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="ikaros-kobcat-gof-de-1.html"/>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Project Overview</a></li>
<li class="chapter" data-level="2" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html"><i class="fa fa-check"></i><b>2</b> Ikaros KO/Bcat GOF DE</a><ul>
<li class="chapter" data-level="2.1" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#setup"><i class="fa fa-check"></i><b>2.2</b> Setup</a></li>
<li class="chapter" data-level="2.3" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#sample-info"><i class="fa fa-check"></i><b>2.3</b> Sample Info</a></li>
<li class="chapter" data-level="2.4" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#differential-expression"><i class="fa fa-check"></i><b>2.4</b> Differential Expression</a></li>
<li class="chapter" data-level="2.5" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#annotate-and-tidy"><i class="fa fa-check"></i><b>2.5</b> Annotate and tidy</a></li>
<li class="chapter" data-level="2.6" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#volano-plot"><i class="fa fa-check"></i><b>2.6</b> Volano plot</a></li>
<li class="chapter" data-level="2.7" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#full-gsea"><i class="fa fa-check"></i><b>2.7</b> Full GSEA</a></li>
<li class="chapter" data-level="2.8" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#select-gsea"><i class="fa fa-check"></i><b>2.8</b> Select GSEA</a></li>
<li class="chapter" data-level="2.9" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#gsea-plots"><i class="fa fa-check"></i><b>2.9</b> GSEA plots</a></li>
<li class="chapter" data-level="2.10" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#downloads"><i class="fa fa-check"></i><b>2.10</b> Downloads</a></li>
<li class="chapter" data-level="2.11" data-path="ikaros-kobcat-gof-de.html"><a href="ikaros-kobcat-gof-de.html#session-info"><i class="fa fa-check"></i><b>2.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ikaros-kobcat-gof-de-1.html"><a href="ikaros-kobcat-gof-de-1.html"><i class="fa fa-check"></i><b>3</b> Ikaros KO/Bcat GOF DE</a><ul>
<li class="chapter" data-level="3.1" data-path="ikaros-kobcat-gof-de-1.html"><a href="ikaros-kobcat-gof-de-1.html#background-1"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="ikaros-kobcat-gof-de-1.html"><a href="ikaros-kobcat-gof-de-1.html#setup-1"><i class="fa fa-check"></i><b>3.2</b> Setup</a></li>
<li class="chapter" data-level="3.3" data-path="ikaros-kobcat-gof-de-1.html"><a href="ikaros-kobcat-gof-de-1.html#load-data"><i class="fa fa-check"></i><b>3.3</b> Load data</a></li>
<li class="chapter" data-level="3.4" data-path="ikaros-kobcat-gof-de-1.html"><a href="ikaros-kobcat-gof-de-1.html#combine"><i class="fa fa-check"></i><b>3.4</b> Combine</a></li>
<li class="chapter" data-level="3.5" data-path="ikaros-kobcat-gof-de-1.html"><a href="ikaros-kobcat-gof-de-1.html#downloads-1"><i class="fa fa-check"></i><b>3.5</b> Downloads</a></li>
<li class="chapter" data-level="3.6" data-path="ikaros-kobcat-gof-de-1.html"><a href="ikaros-kobcat-gof-de-1.html#session-info-1"><i class="fa fa-check"></i><b>3.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>4</b> Appendix</a><ul>
<li class="chapter" data-level="4.1" data-path="appendix.html"><a href="appendix.html#gene-set-sources"><i class="fa fa-check"></i><b>4.1</b> Gene set sources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NC CTNNB1 project - Nehir Cosgun</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ikaros-kobcat-gof-de" class="section level1">
<h1><span class="header-section-number">Section2</span> Ikaros KO/Bcat GOF DE</h1>
<div id="background" class="section level2">
<h2><span class="header-section-number">2.1</span> Background</h2>
<p>To identify genes mis-regulated by beta-catenin (bcat) in an Ikaros-dependent manner, RNA-seq was performed on pre-B cells from CTNNB1^Ex3fl mice that allow inducible bcat gain-of-function (GOF) with addition of Cre. Both GOF and control cells were additionally transfected with sgRNA targetting Ikzf1 and Ikzf3, or not targetting control (NTC) guides.</p>
</div>
<div id="setup" class="section level2">
<h2><span class="header-section-number">2.2</span> Setup</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="ikaros-kobcat-gof-de.html#cb1-1"></a><span class="co"># load libraries</span></span>
<span id="cb1-2"><a href="ikaros-kobcat-gof-de.html#cb1-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="ikaros-kobcat-gof-de.html#cb1-3"></a><span class="kw">library</span>(tximport)</span>
<span id="cb1-4"><a href="ikaros-kobcat-gof-de.html#cb1-4"></a><span class="kw">library</span>(DESeq2)</span>
<span id="cb1-5"><a href="ikaros-kobcat-gof-de.html#cb1-5"></a><span class="kw">library</span>(openxlsx)</span>
<span id="cb1-6"><a href="ikaros-kobcat-gof-de.html#cb1-6"></a><span class="kw">library</span>(DT)</span>
<span id="cb1-7"><a href="ikaros-kobcat-gof-de.html#cb1-7"></a><span class="kw">library</span>(EnsDb.Mmusculus.v79)</span>
<span id="cb1-8"><a href="ikaros-kobcat-gof-de.html#cb1-8"></a>txdb &lt;-<span class="st"> </span>EnsDb.Mmusculus.v79</span>
<span id="cb1-9"><a href="ikaros-kobcat-gof-de.html#cb1-9"></a>  </span>
<span id="cb1-10"><a href="ikaros-kobcat-gof-de.html#cb1-10"></a><span class="co"># make tx2gene</span></span>
<span id="cb1-11"><a href="ikaros-kobcat-gof-de.html#cb1-11"></a>k &lt;-<span class="st"> </span><span class="kw">keys</span>(txdb, <span class="dt">keytype =</span> <span class="st">&quot;TXID&quot;</span>)</span>
<span id="cb1-12"><a href="ikaros-kobcat-gof-de.html#cb1-12"></a>tx2gene &lt;-<span class="st"> </span><span class="kw">select</span>(txdb, k, <span class="st">&quot;GENEID&quot;</span>, <span class="st">&quot;TXID&quot;</span>)</span></code></pre></div>
</div>
<div id="sample-info" class="section level2">
<h2><span class="header-section-number">2.3</span> Sample Info</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="ikaros-kobcat-gof-de.html#cb2-1"></a>files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">&quot;../processed_data/RNAseq/IkKO_bcatGOF_salmon&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;quant.sf&quot;</span>, </span>
<span id="cb2-2"><a href="ikaros-kobcat-gof-de.html#cb2-2"></a>                    <span class="dt">recursive =</span> T, <span class="dt">full.names =</span> T)</span>
<span id="cb2-3"><a href="ikaros-kobcat-gof-de.html#cb2-3"></a>pattern &lt;-<span class="st"> &quot;^.+/Ctnnb1</span><span class="ch">\\</span><span class="st">-GOF_(cre|ert2)</span><span class="ch">\\</span><span class="st">-(NTC|Ikzf1</span><span class="ch">\\</span><span class="st">-3</span><span class="ch">\\</span><span class="st">-KO)</span><span class="ch">\\</span><span class="st">-([0-9])/quant.sf$&quot;</span></span>
<span id="cb2-4"><a href="ikaros-kobcat-gof-de.html#cb2-4"></a>smi &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample_id =</span> <span class="ot">NA</span>,</span>
<span id="cb2-5"><a href="ikaros-kobcat-gof-de.html#cb2-5"></a>                  <span class="dt">treatment =</span> <span class="kw">sub</span>(pattern, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>, files),</span>
<span id="cb2-6"><a href="ikaros-kobcat-gof-de.html#cb2-6"></a>                  <span class="dt">condition =</span> <span class="kw">sub</span>(pattern, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">2&quot;</span>, files),</span>
<span id="cb2-7"><a href="ikaros-kobcat-gof-de.html#cb2-7"></a>                  <span class="dt">replicate =</span> <span class="kw">sub</span>(pattern, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">3&quot;</span>, files)) <span class="op">%&gt;%</span></span>
<span id="cb2-8"><a href="ikaros-kobcat-gof-de.html#cb2-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">condition =</span> <span class="kw">factor</span>(condition, </span>
<span id="cb2-9"><a href="ikaros-kobcat-gof-de.html#cb2-9"></a>                            <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;NTC&quot;</span>,<span class="st">&quot;Ikzf1-3-KO&quot;</span>),</span>
<span id="cb2-10"><a href="ikaros-kobcat-gof-de.html#cb2-10"></a>                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;NTC&quot;</span>,<span class="st">&quot;IkKO&quot;</span>)),</span>
<span id="cb2-11"><a href="ikaros-kobcat-gof-de.html#cb2-11"></a>         <span class="dt">treatment =</span> <span class="kw">factor</span>(treatment, </span>
<span id="cb2-12"><a href="ikaros-kobcat-gof-de.html#cb2-12"></a>                            <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;ert2&quot;</span>,<span class="st">&quot;cre&quot;</span>),</span>
<span id="cb2-13"><a href="ikaros-kobcat-gof-de.html#cb2-13"></a>                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;ERT2&quot;</span>,<span class="st">&quot;CreERT2&quot;</span>)),</span>
<span id="cb2-14"><a href="ikaros-kobcat-gof-de.html#cb2-14"></a>         <span class="dt">combined =</span> <span class="kw">paste0</span>(condition, <span class="st">&quot;_&quot;</span>, treatment),</span>
<span id="cb2-15"><a href="ikaros-kobcat-gof-de.html#cb2-15"></a>         <span class="dt">sample_id =</span> <span class="kw">paste0</span>(combined, <span class="st">&quot;_r&quot;</span>, replicate),</span>
<span id="cb2-16"><a href="ikaros-kobcat-gof-de.html#cb2-16"></a>         <span class="dt">path =</span> files) <span class="op">%&gt;%</span></span>
<span id="cb2-17"><a href="ikaros-kobcat-gof-de.html#cb2-17"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">6</span>)</span>
<span id="cb2-18"><a href="ikaros-kobcat-gof-de.html#cb2-18"></a><span class="kw">names</span>(files) &lt;-<span class="st"> </span>smi<span class="op">$</span>sample_id</span>
<span id="cb2-19"><a href="ikaros-kobcat-gof-de.html#cb2-19"></a>smi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(sample_id) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-20"><a href="ikaros-kobcat-gof-de.html#cb2-20"></a><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">escape  =</span> F, <span class="dt">rownames =</span> F,</span>
<span id="cb2-21"><a href="ikaros-kobcat-gof-de.html#cb2-21"></a>                <span class="dt">colnames =</span> <span class="kw">c</span>(<span class="st">&quot;Sample ID&quot;</span>, <span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Condition&quot;</span>, <span class="st">&quot;Combined&quot;</span>, <span class="st">&quot;Replicate&quot;</span>, <span class="st">&quot;File Path&quot;</span>),</span>
<span id="cb2-22"><a href="ikaros-kobcat-gof-de.html#cb2-22"></a>                <span class="dt">options =</span> <span class="kw">list</span>(</span>
<span id="cb2-23"><a href="ikaros-kobcat-gof-de.html#cb2-23"></a>                  <span class="dt">scrollX =</span> <span class="ot">TRUE</span>,</span>
<span id="cb2-24"><a href="ikaros-kobcat-gof-de.html#cb2-24"></a>                  <span class="dt">columnDefs =</span> <span class="kw">list</span>(<span class="kw">list</span>(</span>
<span id="cb2-25"><a href="ikaros-kobcat-gof-de.html#cb2-25"></a>                        <span class="dt">targets =</span> <span class="dv">5</span>,</span>
<span id="cb2-26"><a href="ikaros-kobcat-gof-de.html#cb2-26"></a>                        <span class="dt">render =</span> <span class="kw">JS</span>(</span>
<span id="cb2-27"><a href="ikaros-kobcat-gof-de.html#cb2-27"></a>                          <span class="st">&quot;function(data, type, row, meta) {&quot;</span>,</span>
<span id="cb2-28"><a href="ikaros-kobcat-gof-de.html#cb2-28"></a>                          <span class="st">&quot;return type === &#39;display&#39; &amp;&amp; data.length &gt; 35 ?&quot;</span>,</span>
<span id="cb2-29"><a href="ikaros-kobcat-gof-de.html#cb2-29"></a>                          <span class="st">&quot;&#39;&lt;span title=</span><span class="ch">\&quot;</span><span class="st">&#39; + data + &#39;</span><span class="ch">\&quot;</span><span class="st">&gt;&#39; + data.substr(0, 35) + &#39;...&lt;/span&gt;&#39; : data;&quot;</span>,</span>
<span id="cb2-30"><a href="ikaros-kobcat-gof-de.html#cb2-30"></a>                          <span class="st">&quot;}&quot;</span>)))</span>
<span id="cb2-31"><a href="ikaros-kobcat-gof-de.html#cb2-31"></a>                ), <span class="dt">callback =</span> <span class="kw">JS</span>(<span class="st">&#39;table.page(3).draw(false);&#39;</span>))</span></code></pre></div>
<div id="htmlwidget-005958ca863cd26dcc06" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-005958ca863cd26dcc06">{"x":{"filter":"none","data":[["IkKO_CreERT2_r1","IkKO_CreERT2_r2","IkKO_CreERT2_r3","IkKO_ERT2_r1","IkKO_ERT2_r2","IkKO_ERT2_r3","NTC_CreERT2_r1","NTC_CreERT2_r2","NTC_CreERT2_r3","NTC_ERT2_r1","NTC_ERT2_r2","NTC_ERT2_r3"],["CreERT2","CreERT2","CreERT2","ERT2","ERT2","ERT2","CreERT2","CreERT2","CreERT2","ERT2","ERT2","ERT2"],["IkKO","IkKO","IkKO","IkKO","IkKO","IkKO","NTC","NTC","NTC","NTC","NTC","NTC"],["IkKO_CreERT2","IkKO_CreERT2","IkKO_CreERT2","IkKO_ERT2","IkKO_ERT2","IkKO_ERT2","NTC_CreERT2","NTC_CreERT2","NTC_CreERT2","NTC_ERT2","NTC_ERT2","NTC_ERT2"],["1","2","3","1","2","3","1","2","3","1","2","3"],["../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_cre-Ikzf1-3-KO-1/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_cre-Ikzf1-3-KO-2/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_cre-Ikzf1-3-KO-3/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_ert2-Ikzf1-3-KO-1/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_ert2-Ikzf1-3-KO-2/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_ert2-Ikzf1-3-KO-3/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_cre-NTC-1/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_cre-NTC-2/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_cre-NTC-3/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_ert2-NTC-1/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_ert2-NTC-2/quant.sf","../processed_data/RNAseq/IkKO_bcatGOF_salmon/Ctnnb1-GOF_ert2-NTC-3/quant.sf"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Sample ID<\/th>\n      <th>Treatment<\/th>\n      <th>Condition<\/th>\n      <th>Combined<\/th>\n      <th>Replicate<\/th>\n      <th>File Path<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"targets":5,"render":"function(data, type, row, meta) {\nreturn type === 'display' && data.length > 35 ?\n'<span title=\"' + data + '\">' + data.substr(0, 35) + '...<\/span>' : data;\n}"}],"order":[],"autoWidth":false,"orderClasses":false},"callback":"function(table) {\ntable.page(3).draw(false);\n}"},"evals":["options.columnDefs.0.render","callback"],"jsHooks":[]}</script>
</div>
<div id="differential-expression" class="section level2">
<h2><span class="header-section-number">2.4</span> Differential Expression</h2>
<ul>
<li>Note 2021-03-05 MER: changed method here vs original analysis on 2020-09-29 to include lfcShrinkage in order to adjust L2FC estimates for low-abundance genes. Majority of changes remain unchanged but some previous outliers such as Brca2 have been substantially decreased.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ikaros-kobcat-gof-de.html#cb3-1"></a>txi &lt;-<span class="st"> </span><span class="kw">tximport</span>(files, <span class="dt">type =</span> <span class="st">&quot;salmon&quot;</span>, <span class="dt">tx2gene =</span> tx2gene, <span class="dt">ignoreTxVersion =</span> T)</span>
<span id="cb3-2"><a href="ikaros-kobcat-gof-de.html#cb3-2"></a>dds &lt;-<span class="st"> </span><span class="kw">DESeqDataSetFromTximport</span>(txi, <span class="dt">colData =</span> smi,</span>
<span id="cb3-3"><a href="ikaros-kobcat-gof-de.html#cb3-3"></a>                                <span class="dt">design =</span> <span class="op">~</span>combined)</span>
<span id="cb3-4"><a href="ikaros-kobcat-gof-de.html#cb3-4"></a>dds &lt;-<span class="st"> </span>dds[<span class="kw">rowMeans</span>(<span class="kw">counts</span>(dds)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>, ]</span>
<span id="cb3-5"><a href="ikaros-kobcat-gof-de.html#cb3-5"></a>dds &lt;-<span class="st"> </span><span class="kw">DESeq</span>(dds)</span>
<span id="cb3-6"><a href="ikaros-kobcat-gof-de.html#cb3-6"></a>contrasts &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">NTC_Cre_vs_NTC_ERT2 =</span> <span class="st">&quot;NTC_CreERT2_vs_NTC_ERT2&quot;</span>,</span>
<span id="cb3-7"><a href="ikaros-kobcat-gof-de.html#cb3-7"></a>                  <span class="dt">Ik_Cre_vs_Ik_ERT2 =</span> <span class="st">&quot;IkKO_CreERT2_vs_IkKO_ERT2&quot;</span>,</span>
<span id="cb3-8"><a href="ikaros-kobcat-gof-de.html#cb3-8"></a>                  <span class="dt">Ik_ERT2_vs_NTC_ERT2 =</span> <span class="st">&quot;IkKO_ERT2_vs_NTC_ERT2&quot;</span>,</span>
<span id="cb3-9"><a href="ikaros-kobcat-gof-de.html#cb3-9"></a>                  <span class="dt">Ik_Cre_vs_NTC_Cre =</span> <span class="st">&quot;IkKO_CreERT2_vs_NTC_CreERT2&quot;</span>)</span>
<span id="cb3-10"><a href="ikaros-kobcat-gof-de.html#cb3-10"></a>deres &lt;-<span class="st"> </span><span class="kw">lapply</span>(contrasts, <span class="cf">function</span>(contrast) {</span>
<span id="cb3-11"><a href="ikaros-kobcat-gof-de.html#cb3-11"></a>  a &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;^(.+)_vs_(.+)$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>, contrast) </span>
<span id="cb3-12"><a href="ikaros-kobcat-gof-de.html#cb3-12"></a>  b &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;^(.+)_vs_(.+)$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">2&quot;</span>, contrast)</span>
<span id="cb3-13"><a href="ikaros-kobcat-gof-de.html#cb3-13"></a>  res &lt;-<span class="st"> </span><span class="kw">results</span>(dds, <span class="dt">contrast=</span><span class="kw">c</span>(<span class="st">&quot;combined&quot;</span>, a, b))</span>
<span id="cb3-14"><a href="ikaros-kobcat-gof-de.html#cb3-14"></a>  <span class="kw">lfcShrink</span>(dds, <span class="dt">contrast =</span> <span class="kw">c</span>(<span class="st">&quot;combined&quot;</span>, a, b), </span>
<span id="cb3-15"><a href="ikaros-kobcat-gof-de.html#cb3-15"></a>            <span class="dt">res =</span> res, <span class="dt">type =</span> <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb3-16"><a href="ikaros-kobcat-gof-de.html#cb3-16"></a>})</span>
<span id="cb3-17"><a href="ikaros-kobcat-gof-de.html#cb3-17"></a>dds2 &lt;-<span class="st"> </span><span class="kw">DESeqDataSetFromTximport</span>(txi, <span class="dt">colData =</span> smi,</span>
<span id="cb3-18"><a href="ikaros-kobcat-gof-de.html#cb3-18"></a>                                <span class="dt">design =</span> <span class="op">~</span>treatment<span class="op">+</span>condition<span class="op">+</span>treatment<span class="op">:</span>condition)</span>
<span id="cb3-19"><a href="ikaros-kobcat-gof-de.html#cb3-19"></a>dds2 &lt;-<span class="st"> </span>dds2[<span class="kw">rowMeans</span>(<span class="kw">counts</span>(dds2)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>, ]</span>
<span id="cb3-20"><a href="ikaros-kobcat-gof-de.html#cb3-20"></a>dds2 &lt;-<span class="st"> </span><span class="kw">DESeq</span>(dds2)</span>
<span id="cb3-21"><a href="ikaros-kobcat-gof-de.html#cb3-21"></a>deres<span class="op">$</span>Cre_Ik_interaction &lt;-<span class="st"> </span><span class="kw">results</span>(dds2, <span class="dt">name =</span> <span class="st">&quot;treatmentCreERT2.conditionIkKO&quot;</span>)</span>
<span id="cb3-22"><a href="ikaros-kobcat-gof-de.html#cb3-22"></a>deres<span class="op">$</span>Cre_Ik_interaction &lt;-<span class="st"> </span><span class="kw">lfcShrink</span>(dds2, <span class="dt">contrast =</span> <span class="st">&quot;treatmentCreERT2.conditionIkKO&quot;</span>,</span>
<span id="cb3-23"><a href="ikaros-kobcat-gof-de.html#cb3-23"></a>                                      <span class="dt">res =</span> deres<span class="op">$</span>Cre_Ik_interaction, <span class="dt">type =</span> <span class="st">&quot;ashr&quot;</span>)</span></code></pre></div>
</div>
<div id="annotate-and-tidy" class="section level2">
<h2><span class="header-section-number">2.5</span> Annotate and tidy</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="ikaros-kobcat-gof-de.html#cb4-1"></a>rlog &lt;-<span class="st"> </span><span class="kw">rlog</span>(dds)</span>
<span id="cb4-2"><a href="ikaros-kobcat-gof-de.html#cb4-2"></a>genesymb &lt;-<span class="st"> </span><span class="kw">mapIds</span>(txdb, <span class="dt">keys =</span> <span class="kw">rownames</span>(deres[[<span class="dv">1</span>]]), </span>
<span id="cb4-3"><a href="ikaros-kobcat-gof-de.html#cb4-3"></a>                   <span class="dt">keytype =</span> <span class="st">&quot;GENEID&quot;</span>, <span class="dt">column =</span> <span class="st">&quot;SYMBOL&quot;</span>)</span>
<span id="cb4-4"><a href="ikaros-kobcat-gof-de.html#cb4-4"></a>deanno &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gene_symbol =</span> genesymb,</span>
<span id="cb4-5"><a href="ikaros-kobcat-gof-de.html#cb4-5"></a>                    <span class="dt">ensembl_id =</span> <span class="kw">rownames</span>(deres[[<span class="dv">1</span>]]),</span>
<span id="cb4-6"><a href="ikaros-kobcat-gof-de.html#cb4-6"></a>                    <span class="dt">L2FC_NTC_Cre_vs_NTC_ERT2 =</span> deres<span class="op">$</span>NTC_Cre_vs_NTC_ERT2<span class="op">$</span>log2FoldChange,</span>
<span id="cb4-7"><a href="ikaros-kobcat-gof-de.html#cb4-7"></a>                    <span class="dt">L2FC_Ik_Cre_vs_Ik_ERT2 =</span> deres<span class="op">$</span>Ik_Cre_vs_Ik_ERT2<span class="op">$</span>log2FoldChange,</span>
<span id="cb4-8"><a href="ikaros-kobcat-gof-de.html#cb4-8"></a>                    <span class="dt">L2FC_Ik_ERT2_vs_NTC_ERT2 =</span> deres<span class="op">$</span>Ik_ERT2_vs_NTC_ERT2<span class="op">$</span>log2FoldChange,</span>
<span id="cb4-9"><a href="ikaros-kobcat-gof-de.html#cb4-9"></a>                    <span class="dt">L2FC_Ik_Cre_vs_NTC_Cre =</span> deres<span class="op">$</span>Ik_Cre_vs_NTC_Cre<span class="op">$</span>log2FoldChange,</span>
<span id="cb4-10"><a href="ikaros-kobcat-gof-de.html#cb4-10"></a>                    <span class="dt">L2FC_Cre_Ik_interaction =</span> deres<span class="op">$</span>Ik_Cre_vs_Ik_ERT2<span class="op">$</span>log2FoldChange <span class="op">-</span><span class="st"> </span>deres<span class="op">$</span>NTC_Cre_vs_NTC_ERT2<span class="op">$</span>log2FoldChange,</span>
<span id="cb4-11"><a href="ikaros-kobcat-gof-de.html#cb4-11"></a>                    <span class="dt">padj_NTC_Cre_vs_NTC_ERT2 =</span> deres<span class="op">$</span>NTC_Cre_vs_NTC_ERT2<span class="op">$</span>padj,</span>
<span id="cb4-12"><a href="ikaros-kobcat-gof-de.html#cb4-12"></a>                    <span class="dt">padj_Ik_Cre_vs_Ik_ERT2 =</span> deres<span class="op">$</span>Ik_Cre_vs_Ik_ERT2<span class="op">$</span>padj,</span>
<span id="cb4-13"><a href="ikaros-kobcat-gof-de.html#cb4-13"></a>                    <span class="dt">padj_Ik_ERT2_vs_NTC_ERT2 =</span> deres<span class="op">$</span>Ik_ERT2_vs_NTC_ERT2<span class="op">$</span>padj,</span>
<span id="cb4-14"><a href="ikaros-kobcat-gof-de.html#cb4-14"></a>                    <span class="dt">padj_Ik_Cre_vs_NTC_Cre =</span> deres<span class="op">$</span>Ik_Cre_vs_NTC_Cre<span class="op">$</span>padj,</span>
<span id="cb4-15"><a href="ikaros-kobcat-gof-de.html#cb4-15"></a>                    <span class="dt">padj_Cre_Ik_interaction =</span> deres<span class="op">$</span>Cre_Ik_interaction<span class="op">$</span>padj,</span>
<span id="cb4-16"><a href="ikaros-kobcat-gof-de.html#cb4-16"></a>                    <span class="dt">av_expr =</span> <span class="kw">rowMeans</span>(<span class="kw">assay</span>(rlog)),</span>
<span id="cb4-17"><a href="ikaros-kobcat-gof-de.html#cb4-17"></a>                    <span class="dt">av_NTC_ERT2 =</span> <span class="kw">rowMeans</span>(<span class="kw">assay</span>(rlog)[,<span class="kw">grep</span>(<span class="st">&quot;NTC_ERT2&quot;</span>, <span class="kw">colnames</span>(rlog))]),</span>
<span id="cb4-18"><a href="ikaros-kobcat-gof-de.html#cb4-18"></a>                    <span class="dt">av_NTC_Cre =</span> <span class="kw">rowMeans</span>(<span class="kw">assay</span>(rlog)[,<span class="kw">grep</span>(<span class="st">&quot;NTC_CreERT2&quot;</span>, <span class="kw">colnames</span>(rlog))]),</span>
<span id="cb4-19"><a href="ikaros-kobcat-gof-de.html#cb4-19"></a>                    <span class="dt">av_IkKO_ERT2 =</span> <span class="kw">rowMeans</span>(<span class="kw">assay</span>(rlog)[,<span class="kw">grep</span>(<span class="st">&quot;IkKO_ERT2&quot;</span>, <span class="kw">colnames</span>(rlog))]),</span>
<span id="cb4-20"><a href="ikaros-kobcat-gof-de.html#cb4-20"></a>                    <span class="dt">av_IkKO_Cre =</span> <span class="kw">rowMeans</span>(<span class="kw">assay</span>(rlog)[,<span class="kw">grep</span>(<span class="st">&quot;IkKO_CreERT2&quot;</span>, <span class="kw">colnames</span>(rlog))]))</span>
<span id="cb4-21"><a href="ikaros-kobcat-gof-de.html#cb4-21"></a>deanno &lt;-<span class="st"> </span><span class="kw">cbind</span>(deanno, <span class="kw">assay</span>(rlog))</span>
<span id="cb4-22"><a href="ikaros-kobcat-gof-de.html#cb4-22"></a><span class="kw">write.xlsx</span>(deanno, <span class="st">&quot;../results/IkKO_bcatGOF_DE.2021-03-05.xlsx&quot;</span>, <span class="dt">firstRow =</span> <span class="ot">TRUE</span>, <span class="dt">firstCol =</span> <span class="ot">TRUE</span>) </span>
<span id="cb4-23"><a href="ikaros-kobcat-gof-de.html#cb4-23"></a><span class="kw">saveRDS</span>(deanno, <span class="st">&quot;../processed_data/RNAseq/IkKO_bcatGOF_DE.2021-03-05.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="ikaros-kobcat-gof-de.html#cb5-1"></a>deanno &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;../processed_data/RNAseq/IkKO_bcatGOF_DE.2021-03-05.rds&quot;</span>)</span>
<span id="cb5-2"><a href="ikaros-kobcat-gof-de.html#cb5-2"></a>contrasts &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">NTC_Cre_vs_NTC_ERT2 =</span> <span class="st">&quot;NTC_Cre_vs_NTC_ERT2&quot;</span>,</span>
<span id="cb5-3"><a href="ikaros-kobcat-gof-de.html#cb5-3"></a>                  <span class="dt">Ik_Cre_vs_Ik_ERT2 =</span> <span class="st">&quot;Ik_Cre_vs_Ik_ERT2&quot;</span>,</span>
<span id="cb5-4"><a href="ikaros-kobcat-gof-de.html#cb5-4"></a>                  <span class="dt">Ik_ERT2_vs_NTC_ERT2 =</span> <span class="st">&quot;Ik_ERT2_vs_NTC_ERT2&quot;</span>,</span>
<span id="cb5-5"><a href="ikaros-kobcat-gof-de.html#cb5-5"></a>                  <span class="dt">Ik_Cre_vs_NTC_Cre =</span> <span class="st">&quot;Ik_Cre_vs_NTC_Cre&quot;</span>,</span>
<span id="cb5-6"><a href="ikaros-kobcat-gof-de.html#cb5-6"></a>                  <span class="dt">Cre_Ik_interaction =</span> <span class="st">&quot;Cre_Ik_interaction&quot;</span>)</span>
<span id="cb5-7"><a href="ikaros-kobcat-gof-de.html#cb5-7"></a><span class="kw">lapply</span>(contrasts, <span class="cf">function</span>(x) {</span>
<span id="cb5-8"><a href="ikaros-kobcat-gof-de.html#cb5-8"></a>  deanno[, <span class="kw">grep</span>(x, <span class="kw">colnames</span>(deanno))] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-9"><a href="ikaros-kobcat-gof-de.html#cb5-9"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(.[,<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">%&gt;%</span></span>
<span id="cb5-10"><a href="ikaros-kobcat-gof-de.html#cb5-10"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">condition =</span> x,</span>
<span id="cb5-11"><a href="ikaros-kobcat-gof-de.html#cb5-11"></a>              <span class="dt">upreg =</span> <span class="kw">nrow</span>(.[.[,<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.58</span>, ]),</span>
<span id="cb5-12"><a href="ikaros-kobcat-gof-de.html#cb5-12"></a>              <span class="dt">dnreg =</span> <span class="kw">nrow</span>(.[.[,<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span><span class="fl">-0.58</span>, ]))</span>
<span id="cb5-13"><a href="ikaros-kobcat-gof-de.html#cb5-13"></a>}) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span><span class="st"> </span>kableExtra<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
condition
</th>
<th style="text-align:right;">
upreg
</th>
<th style="text-align:right;">
dnreg
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
NTC_Cre_vs_NTC_ERT2
</td>
<td style="text-align:right;">
176
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;">
Ik_Cre_vs_Ik_ERT2
</td>
<td style="text-align:right;">
227
</td>
<td style="text-align:right;">
46
</td>
</tr>
<tr>
<td style="text-align:left;">
Ik_ERT2_vs_NTC_ERT2
</td>
<td style="text-align:right;">
1680
</td>
<td style="text-align:right;">
1183
</td>
</tr>
<tr>
<td style="text-align:left;">
Ik_Cre_vs_NTC_Cre
</td>
<td style="text-align:right;">
1681
</td>
<td style="text-align:right;">
1165
</td>
</tr>
<tr>
<td style="text-align:left;">
Cre_Ik_interaction
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
52
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="ikaros-kobcat-gof-de.html#cb6-1"></a>deanno <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-2"><a href="ikaros-kobcat-gof-de.html#cb6-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(padj_Cre_Ik_interaction <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-3"><a href="ikaros-kobcat-gof-de.html#cb6-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(padj_Cre_Ik_interaction) <span class="op">%&gt;%</span></span>
<span id="cb6-4"><a href="ikaros-kobcat-gof-de.html#cb6-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">14</span><span class="op">:</span><span class="dv">17</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-5"><a href="ikaros-kobcat-gof-de.html#cb6-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">round</span>(x, <span class="dv">3</span>)) <span class="op">%&gt;%</span></span>
<span id="cb6-6"><a href="ikaros-kobcat-gof-de.html#cb6-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>, <span class="cf">function</span>(x) <span class="kw">round</span>(x, <span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb6-7"><a href="ikaros-kobcat-gof-de.html#cb6-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="dv">3</span>, <span class="cf">function</span>(x) <span class="kw">formatC</span>(x, <span class="dt">format =</span> <span class="st">&quot;e&quot;</span>, <span class="dt">digits =</span> <span class="dv">3</span>)) <span class="op">%&gt;%</span></span>
<span id="cb6-8"><a href="ikaros-kobcat-gof-de.html#cb6-8"></a><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">escape  =</span> F, <span class="dt">rownames =</span> F,</span>
<span id="cb6-9"><a href="ikaros-kobcat-gof-de.html#cb6-9"></a>                <span class="dt">options =</span> <span class="kw">list</span>(</span>
<span id="cb6-10"><a href="ikaros-kobcat-gof-de.html#cb6-10"></a>                  <span class="dt">columnDefs =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">className =</span> <span class="st">&#39;dt-right&#39;</span>, <span class="dt">targets =</span> <span class="dv">2</span>)),</span>
<span id="cb6-11"><a href="ikaros-kobcat-gof-de.html#cb6-11"></a>                  <span class="dt">scrollX =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-c3a47e233dbc5452dfb9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c3a47e233dbc5452dfb9">{"x":{"filter":"none","data":[["Tmem119","Dntt","Scn2b","Tcrg-C2","Dtx4","Myc","Sema7a","Iqgap2","Ccnd2","Tcrg-C1","Enpep","Aplp2","Gm5537","Syk","Pla2g2f","Sbk1","Ets1","Cd24a","Rassf4","Abhd2","Megf10","Eps8","Ngfrap1","Cebpb","Akap2","Tmem229b","Cdkn2a","Igfbp4","Tubb3","Pggt1b","Spata13","Cpm","Rab31","Zfp36l2","Lmo2","Ndst1","Cxcr4","Slc1a5","Ndc1","Ezr","D8Ertd82e","Ube2j1","Rasgrp1","Ehd2","Adamtsl2","Ptpn22","Spn","Gas7","Pdzd2","Irf4","Erc1","Ctse","Csf2rb","Phlda1","Ighv5-4","Zfp462","Olfm1","BC034090","Slc16a1","Samhd1","Chst11","Slc29a3","Car2","Immt","Rap1gap","Gsto1","Serpinf1","Napsa","Adssl1","Rel","Rac2","Mettl8","Gnb4","Cd84","Gas2l3","Il17rd","Pou2af1","Gadd45a","Lcp2","Asns","Adrbk1","Lat","Tbx19","Map3k5","Jade2","Prkd2","Sh3pxd2a","Jade3","Slc29a1","Glipr2","Rragd","Erf","Mthfd1l","Fyn","Scd2","Gm9581","Cd93","Snx5","Kmt2d","Apon","Brd7","Pcp4","Slc39a14","4632428N05Rik","Rgl1","Lgals9","Gja1","6820431F20Rik","Dab2ip","Arhgef1","Cnn3","Tpcn1","Cep164","Mpzl2","Nsdhl","Kremen1","Fam101b","Pdia6","Nov","Gm15501","Tal1","Slc16a3","Dio2","Sash3","Tns3","Cdh17","Smtn","Ski","Clstn1","Brca2","H2afy","Fam46c","Gnb1","Prkcb","Tm2d1","Heatr1","Alpl","Usp11","Nfatc3","Cyth4","Mtap","Fam102b","Mgat4a","Exoc3l","Gm2026","Prnp","Rps6ka1","Fads2","Cysltr1","Zfp760","Arap2","Pdrg1","Mapkapk2","Atp13a2","Fut10","Mthfd2","Cd28","Coro7","Tnfrsf1b","Esyt2","Csf2rb2","Ebf1","Kbtbd11","Wipi1","Frmd4a","Rcbtb2","Slamf7","Itga6","Me2","Tmsb4x","Dennd3","Lrig2","Ripk3","Ifitm1","Por","Slamf1","Adipor2","Fbxl12","Ly75","Cpne1","Rnf145","Gm15459","Ddx19a","Zeb2","Hmgcs1","6330403A02Rik","Stk4","Gbp7","Epha2","Fetub","Tmem176b","Fam73a","Ablim1","PCDHGB6","1110037F02Rik","Ctnna1","Tgfb3","Sipa1","Sept6","Vasp","Aldh18a1","Tnfsf8","Ass1","Ctsb","Kpna2","Pes1","Fut4","Eif5a","Pyhin1","Fasn","Foxn3","Syndig1l","Slc44a1","Vegfa","Hipk1","Hspa8","Pxn","Tecpr1","Calr","Asph","Srm","Spry1","Tpr","Bcl7a","Gnao1","Wnk1","Ltbp4","Ubxn7","Ctla4","Klhl14","Stac2","Psme3","Filip1","Tcf7","Maged1","Klhl6","Axin2","Arhgap18","Dtx2","Rab21","Prkar2b","Nt5dc2","Tanc1","Fam3c","Mvd","2810429I04Rik","Hp1bp3","A630001G21Rik","Lxn","E130012A19Rik","Ikzf1","Foxo1","Gbe1","Tfap2b","Xkr7","Wipf1","Mospd3","Sult1a1","Etv1","Tifab","Scarb1","Nfix","Ubap2","Rrm1","C2cd5","Dhcr24","Lgals8","Bcar3","Hyou1","Kirrel","Nrxn1","Lrrn4","Cyfip2","Il33","Hnrnpll","Noc2l","Ahcy","Cd248","Ogdh","Acat2","Tnfrsf19","Ugcg","Rgs10","Zap70","Btbd7","Gng4","Itgb5","Tgfbr2","Qsox1","Cdc25b","Camk2d","Sept8","Anxa6","Neto2","Kynu","Ybx3","Ccnk","Tagap","Serf1","Nr4a1","Runx3","Hnrnpa0","Cd244","Cndp2","Mcm9","P4hb","Stxbp1","Inadl","Msi2","Spr","Pdk1","Palm","Ero1l","Inf2","Zfpm1","Txnrd2","Il2ra","Vcl","Zbp1","Shf","Osr2","Ighg2b","Cst7","Sema4d","Dennd4a","Sun2","Sars","Ptov1","Fermt3","Amica1","BC005561","Gm7536","Med13l","Sptssa","Wbp5","Clic5","Tbrg1","Rgs8","Rdh13","Btg2","Tubb2b","Cyp51","Lamc1","Rmnd5b","Gars","Gclc","Plcg2","Rpn1","Eif4g1","Smyd4","Car13","Myadm","Suz12","Cops4","Srebf1","Cpt1a","Polr2b","Triobp","Lrch2","Leprotl1","Gm4294","8430419L09Rik","Zc3h12d","Slc7a5","Mfsd4","Tuba1a","Gnl3","Xpnpep3","Limd2","Tmem97","Gm21992","Sertad4","St5","Prkcq","Ptk2b","Cdc42se2","Trim8","Stk10","Ttll1","Ube4a","Dhcr7","Rpn2","Slc9a3r1","Traf4","B3gnt2","Nsun2","Ddost","Ddx1","Xylt1","Cltc","Frmd6","Acp2","Fam117b","Emp1","Camkk2","Snx8","Pydc4","Parp14","Lif","Rpl22","Plac8","Ptbp3","Pdzd4","Fam43a","Xrcc5","Tbc1d1","Rin3","Nsmce4a","Isyna1","Dkc1","Cobll1","Atp13a3","Ppib","Txn2","Arhgef18","Ddx49","Rpl11","RP23-354D10.5","Mbp","Frat2","Nudt4","Trp53inp1","Crnkl1","Phgdh","Cfap45","St3gal5","Ipmk","Myo1c","Dusp4","Chst3","Mical1","Dusp5","Eef2k","Serpinb1a","Smyd2","Ppp1r10","Mycbp2","Dnaja1","Wrnip1","Deptor","D5Ertd579e","Myo10","Arhgap30","Hspd1","Recql","Mroh2a","Eif2ak3","Socs5","Ptpn7","Tmod3","Myo1g","Rps8","Ly9","Huwe1","mt-Nd4l","Usp47","H1f0","Pim2","Dnajb11","Sell","Drc7","Gm13509","Hook3","Pxylp1","Cdca7","Rad51","Sdc4","Mbtd1","Rpl13a","Fundc1","Nifk","Maml3","Arl14ep","Ell2","Vps39","Pak4","Noc3l","Klf6","Cpd","Ankrd6","Utrn","Sap18","Manf","Nme2","Fam222a","Ankrd33b","Sigmar1","Nat10","Mrps11","Rai14","4931406P16Rik","WI1-817D1.2","Rexo1","Rell1","Usp25","Sqle","Rab7","Cep170","Bambi","Ncoa2","Ppa1","Gm6565","Mki67","Dennd4c","Acsl3","Snx9","Slc30a4","Coa6","Abl2","Mns1","Mef2d","Slc7a11","Ankrd44","Lifr","Vav2","Tsn","Zdhhc18","Sash1","Pak2","Npepl1","Gnai1","Raph1","Fam189b","Mpeg1","Gm2223","Xxylt1","Pea15a","Cct6a","Cirh1a","Fdps","Ogfrl1","Apobec1","Dscr3","Cth","Csk","Gfra1","Rpl15-ps3","Etv5","Spcs2","Acot7","Stard4","Rps17","Hspa5","Rpl37","Sgms1","Nlrc3","Ifitm2","Clasp1","Eef1g","Gmfb","Acaca","Kat2a","Dido1"],[-2.323,0.661,1.84,1.045,1.727,0.474,2.102,1.201,0.629,0.698,-0.614,0.826,-6.269,0.502,2.464,0.616,-0.503,-0.326,-1.282,0.632,-0.719,0.763,-1.45,4.013,-2.357,0.625,1.226,-0.786,-0.623,3.859,-0.361,-1.395,0.768,0.46,1.897,-1.257,0.359,-0.462,0.405,-0.398,1.156,-0.27,0.686,0.813,3.083,-0.758,0.241,2.349,0.966,0.371,-0.465,0.53,0.403,0.598,3.41,-1.153,2.559,2.483,0.299,1.08,1.436,0.786,0.301,0.251,2.63,0.913,1.165,0.342,0.849,-0.404,0.232,0.674,-0.386,0.504,0.388,1.521,-0.174,1.186,0.693,-0.349,-0.28,-0.37,-0.836,-0.313,-0.48,-0.365,0.548,0.539,0.288,-0.368,-0.318,0.991,-0.208,-0.243,0.259,0.597,-0.285,0.192,-0.538,2.035,0.374,5.95,0.548,1.118,0.252,-0.191,0.447,-0.387,-0.64,-0.274,0.388,0.393,-0.329,1.461,0.386,-0.719,1.101,0.2,0.534,-2.252,1.231,0.489,0.374,-0.245,0.295,0.333,-0.241,0.737,0.438,0.101,0.145,1.235,-0.123,0.297,-1.306,0.279,0.216,-0.521,-0.201,0.846,0.235,0.898,0.689,1.688,-1.29,0.314,0.528,0.224,2.134,0.737,0.408,0.55,0.211,-0.317,0.944,-0.218,1.887,-0.313,0.392,0.361,0.952,-0.243,-0.389,1.245,-0.616,0.33,0.554,-0.252,-0.206,0.204,0.695,0.664,-0.437,2.553,0.615,1.072,0.195,-0.904,-0.596,-0.38,-0.339,0.194,0.247,0.497,0.272,-2.485,0.159,0.154,0.314,0.625,1.496,-0.698,-0.256,-0.221,0.207,-0.26,-0.628,-0.207,-0.202,-0.22,-0.219,0.599,0.512,0.24,0.205,0.295,0.894,0.139,0.308,-0.465,-0.528,-0.325,-1.044,-0.289,0.249,0.196,0.335,-0.41,0.171,0.436,0.297,0.711,-0.155,-0.284,1.467,-0.341,0.462,-0.481,1.248,0.579,0.943,0.169,-1.017,0.889,-0.648,0.179,0.384,-0.443,0.39,-0.237,-0.255,0.76,-0.259,0.463,0.526,0.636,-0.165,-0.491,-0.326,0.856,-0.13,-0.24,-0.297,-1.103,2.855,-0.262,-0.311,4.553,1.035,0.521,0.249,0.432,0.232,0.123,-0.276,0.256,-0.465,-0.43,0.236,0.347,0.473,0.438,-0.181,-0.913,0.262,0.141,0.277,0.477,0.156,0.323,0.363,-0.334,1.132,0.705,1.128,0.424,0.835,0.196,-1.08,-0.241,-0.35,0.56,-0.185,-1.075,0.659,0.272,-0.368,0.912,1.552,1.343,0.292,-0.136,0.648,0.307,-0.031,0.206,-0.169,-0.653,0.138,0.817,-0.176,-0.21,-0.386,0.974,-0.231,-0.626,0.366,0.326,1.059,1.066,0.706,-1.509,0.86,-0.269,0.189,-0.283,-0.256,0.79,-0.157,1.153,-1.125,0.154,-0.218,0.28,-0.632,0.634,-0.246,-0.363,0.677,0.424,-0.345,0.254,0.291,-0.354,-0.162,-0.254,0.158,0.211,0.138,-0.628,-0.254,0.441,-0.165,0.222,0.386,-0.227,0.145,-0.241,-0.597,-0.243,0.037,-0.456,-0.585,-0.113,-0.527,0.233,0.22,-0.424,-0.186,0.235,1.404,-0.375,1.415,0.39,0.216,-0.186,-0.262,-0.196,-0.514,0.222,0.284,0.156,-0.202,-0.231,0.671,0.163,0.17,0.137,-0.732,-0.088,0.277,1.467,-0.312,0.49,0.221,0.78,-1.038,-0.221,-0.661,0.157,0.189,0.141,1.606,0.784,-0.194,-0.22,-0.253,0.174,0.335,0.156,0.501,-0.228,0.206,0.225,-1.126,0.31,0.113,-0.363,-0.266,1.002,0.187,-0.352,0.214,-0.126,0.635,1.491,-0.146,-0.156,-0.415,-0.264,-0.209,0.259,-0.143,0.542,0.348,0.251,-0.229,0.137,-0.248,0.591,-0.297,0.624,-0.145,0.134,0.523,1.044,0.268,0.545,0.185,0.206,-0.169,0.133,-0.196,0.25,0.305,-0.208,0.27,-0.316,0.185,0.478,0.308,-1.119,0.402,-0.672,-0.173,0.271,0.201,0.372,0.153,-0.345,0.177,0.294,-0.27,0.32,-0.338,0.918,0.299,-0.231,0.214,-0.441,-0.343,-0.676,0.164,0.243,1.199,0.437,0.269,0.289,0.35,0.314,0.388,-1.115,-0.257,-0.303,-0.148,0.187,0.161,-0.223,1.109,0.248,0.19,-0.036,0.145,0.212,0.451,-0.188,0.288,0.766,0.317,0.41,-0.134,1.427,-0.233,0.984,-0.302,0.15,-0.434,0.541,-0.121,0.473,-0.713,-0.751,-1.337,1.316,0.618,0.411,-0.942,0.306,0.195,0.254,-0.254,-0.321,-0.433,-0.407,0.19,0.209,0.274,0.163,0.938,-0.196,0.275,0.178,0.219,0.159,0.57,-0.38,0.213,0.183,0.111,-0.229,0.185,0.209,0.246],["8.539e-51","5.524e-50","3.231e-42","8.658e-35","1.241e-34","2.669e-33","2.873e-32","1.555e-29","1.489e-28","5.961e-27","2.031e-26","3.872e-26","4.355e-23","1.245e-22","3.397e-21","5.370e-20","1.645e-18","2.805e-18","9.699e-18","1.561e-17","6.363e-17","8.125e-16","3.623e-15","5.647e-14","1.175e-13","1.262e-12","3.287e-12","4.344e-12","4.344e-12","5.746e-12","6.750e-12","1.022e-11","2.173e-11","2.608e-11","3.063e-11","3.709e-11","3.805e-11","1.164e-10","1.220e-10","2.130e-10","5.876e-10","6.682e-10","7.387e-10","1.139e-09","2.535e-09","5.229e-09","5.229e-09","7.147e-09","1.333e-08","1.357e-08","1.856e-08","2.140e-08","2.502e-08","3.703e-08","4.025e-08","5.382e-08","9.360e-08","9.615e-08","1.327e-07","1.442e-07","1.529e-07","1.722e-07","3.964e-07","5.007e-07","5.899e-07","7.161e-07","7.428e-07","7.428e-07","7.474e-07","8.076e-07","8.868e-07","9.082e-07","1.004e-06","1.157e-06","1.157e-06","1.623e-06","1.648e-06","1.747e-06","2.800e-06","2.800e-06","2.847e-06","3.109e-06","3.767e-06","3.983e-06","4.143e-06","4.272e-06","4.272e-06","5.037e-06","5.644e-06","6.440e-06","6.812e-06","6.812e-06","6.983e-06","1.017e-05","1.197e-05","1.427e-05","1.506e-05","1.731e-05","1.989e-05","1.989e-05","2.281e-05","2.285e-05","2.417e-05","2.515e-05","3.204e-05","3.260e-05","3.284e-05","3.517e-05","3.750e-05","3.827e-05","3.827e-05","3.977e-05","4.046e-05","4.991e-05","5.435e-05","5.623e-05","5.623e-05","5.891e-05","5.916e-05","6.249e-05","6.534e-05","6.737e-05","7.436e-05","8.697e-05","8.897e-05","8.964e-05","9.361e-05","9.501e-05","9.501e-05","9.590e-05","1.029e-04","1.105e-04","1.152e-04","1.167e-04","1.170e-04","1.170e-04","1.231e-04","1.260e-04","1.267e-04","1.286e-04","1.292e-04","1.500e-04","1.516e-04","1.575e-04","1.685e-04","1.735e-04","1.752e-04","1.752e-04","1.752e-04","1.752e-04","2.008e-04","2.042e-04","2.242e-04","2.322e-04","2.327e-04","2.371e-04","2.542e-04","2.542e-04","2.651e-04","2.751e-04","2.814e-04","3.005e-04","3.021e-04","3.458e-04","3.665e-04","3.789e-04","4.017e-04","4.040e-04","4.223e-04","4.447e-04","4.712e-04","4.732e-04","4.949e-04","4.958e-04","5.064e-04","5.275e-04","5.334e-04","5.370e-04","5.385e-04","5.385e-04","5.562e-04","5.562e-04","5.574e-04","5.679e-04","5.679e-04","5.910e-04","5.964e-04","5.964e-04","6.057e-04","6.057e-04","6.200e-04","6.333e-04","6.348e-04","6.523e-04","6.607e-04","6.627e-04","6.746e-04","6.886e-04","6.900e-04","7.124e-04","8.518e-04","8.968e-04","9.317e-04","9.469e-04","1.004e-03","1.041e-03","1.110e-03","1.133e-03","1.181e-03","1.211e-03","1.242e-03","1.242e-03","1.289e-03","1.303e-03","1.323e-03","1.382e-03","1.401e-03","1.401e-03","1.448e-03","1.472e-03","1.608e-03","1.644e-03","1.726e-03","1.726e-03","1.726e-03","1.726e-03","1.748e-03","1.751e-03","1.771e-03","1.781e-03","1.783e-03","1.835e-03","1.907e-03","1.981e-03","2.010e-03","2.056e-03","2.129e-03","2.228e-03","2.280e-03","2.280e-03","2.569e-03","2.744e-03","2.759e-03","2.792e-03","2.836e-03","2.860e-03","2.863e-03","2.868e-03","2.872e-03","2.895e-03","2.916e-03","2.933e-03","3.009e-03","3.009e-03","3.009e-03","3.009e-03","3.098e-03","3.100e-03","3.129e-03","3.173e-03","3.225e-03","3.227e-03","3.239e-03","3.239e-03","3.343e-03","3.362e-03","3.448e-03","3.761e-03","3.828e-03","3.853e-03","3.880e-03","4.041e-03","4.083e-03","4.083e-03","4.095e-03","4.102e-03","4.116e-03","4.128e-03","4.146e-03","4.219e-03","4.307e-03","4.443e-03","4.488e-03","4.677e-03","4.865e-03","4.944e-03","4.944e-03","4.944e-03","4.944e-03","5.112e-03","5.126e-03","5.139e-03","5.166e-03","5.166e-03","5.167e-03","5.226e-03","5.360e-03","5.690e-03","5.691e-03","5.764e-03","5.764e-03","5.830e-03","5.842e-03","5.842e-03","5.842e-03","5.889e-03","5.889e-03","5.889e-03","5.889e-03","5.905e-03","5.921e-03","5.928e-03","5.987e-03","6.035e-03","6.042e-03","6.042e-03","6.119e-03","6.299e-03","6.299e-03","6.336e-03","6.453e-03","6.555e-03","6.644e-03","6.653e-03","6.896e-03","6.956e-03","7.017e-03","7.112e-03","7.120e-03","7.121e-03","7.173e-03","7.312e-03","7.320e-03","7.327e-03","7.468e-03","7.547e-03","7.969e-03","8.031e-03","8.153e-03","8.153e-03","8.408e-03","8.440e-03","8.566e-03","8.933e-03","9.235e-03","9.255e-03","9.514e-03","9.545e-03","9.580e-03","9.586e-03","9.818e-03","9.818e-03","9.884e-03","9.901e-03","1.005e-02","1.027e-02","1.046e-02","1.046e-02","1.077e-02","1.077e-02","1.077e-02","1.089e-02","1.089e-02","1.089e-02","1.089e-02","1.089e-02","1.113e-02","1.124e-02","1.124e-02","1.145e-02","1.147e-02","1.159e-02","1.167e-02","1.205e-02","1.264e-02","1.294e-02","1.295e-02","1.331e-02","1.331e-02","1.363e-02","1.367e-02","1.383e-02","1.389e-02","1.430e-02","1.450e-02","1.452e-02","1.484e-02","1.527e-02","1.568e-02","1.611e-02","1.672e-02","1.722e-02","1.722e-02","1.733e-02","1.738e-02","1.738e-02","1.738e-02","1.739e-02","1.743e-02","1.744e-02","1.802e-02","1.845e-02","1.862e-02","1.903e-02","1.913e-02","1.913e-02","1.913e-02","1.917e-02","1.929e-02","1.950e-02","1.988e-02","1.992e-02","1.992e-02","1.995e-02","1.998e-02","2.013e-02","2.016e-02","2.016e-02","2.017e-02","2.018e-02","2.031e-02","2.039e-02","2.082e-02","2.090e-02","2.105e-02","2.105e-02","2.105e-02","2.134e-02","2.134e-02","2.176e-02","2.176e-02","2.176e-02","2.176e-02","2.176e-02","2.218e-02","2.253e-02","2.336e-02","2.361e-02","2.387e-02","2.388e-02","2.388e-02","2.415e-02","2.448e-02","2.456e-02","2.515e-02","2.515e-02","2.517e-02","2.554e-02","2.560e-02","2.560e-02","2.574e-02","2.579e-02","2.580e-02","2.657e-02","2.657e-02","2.668e-02","2.668e-02","2.678e-02","2.680e-02","2.692e-02","2.692e-02","2.703e-02","2.759e-02","2.760e-02","2.772e-02","2.800e-02","2.802e-02","2.802e-02","2.802e-02","2.865e-02","2.947e-02","2.947e-02","2.952e-02","2.952e-02","2.958e-02","2.974e-02","2.997e-02","3.034e-02","3.034e-02","3.062e-02","3.065e-02","3.065e-02","3.065e-02","3.140e-02","3.188e-02","3.217e-02","3.239e-02","3.267e-02","3.269e-02","3.277e-02","3.277e-02","3.277e-02","3.365e-02","3.376e-02","3.381e-02","3.417e-02","3.418e-02","3.435e-02","3.444e-02","3.488e-02","3.537e-02","3.537e-02","3.537e-02","3.539e-02","3.566e-02","3.578e-02","3.579e-02","3.579e-02","3.602e-02","3.644e-02","3.649e-02","3.649e-02","3.649e-02","3.685e-02","3.721e-02","3.860e-02","3.860e-02","3.895e-02","3.895e-02","3.895e-02","3.919e-02","3.921e-02","3.980e-02","3.980e-02","3.998e-02","4.198e-02","4.241e-02","4.241e-02","4.241e-02","4.241e-02","4.242e-02","4.243e-02","4.246e-02","4.271e-02","4.302e-02","4.373e-02","4.462e-02","4.565e-02","4.702e-02","4.732e-02","4.739e-02","4.747e-02","4.814e-02","4.894e-02","4.902e-02","4.902e-02","4.902e-02","4.902e-02","4.902e-02","4.905e-02","4.944e-02","4.953e-02","4.957e-02"],[8.07,12.64,8.46,11.41,8,12.21,7.9,10.01,13.78,11.86,13.07,11.1,7.57,13.69,7.21,10.68,12.33,15.01,8.06,11.57,9.35,10.5,7.45,5.8,6.5,10.75,8.29,9.85,10.51,6.22,12.61,8.25,9.23,11.18,6.86,9.08,12.03,12.17,12.44,14.02,7.82,13.31,10.98,9.44,4.98,9.51,12.76,6.85,8.48,12.28,9.61,10.18,12,9.07,4.66,7.52,5.07,5.33,13.65,8.69,7.4,8.84,12.66,12.06,4.65,8.24,8.01,11.81,8.15,10.81,13.52,9.1,12.05,9.53,10.99,6.17,14.26,7.35,9.53,12.57,14.06,10.74,7.14,11.43,11.31,11.58,9.31,9.86,12.27,11,11.36,7.45,12.5,11.93,14.44,8.64,13.9,13.29,11.66,3.94,11.41,5.25,9.96,8.76,12.13,13.66,11.61,10.88,9.71,12.3,10.95,11.27,11.04,6.32,10.29,8.07,6.98,12.79,9.97,4.46,6.57,9.45,10.68,12.97,10.85,10.71,11.67,8.16,11.04,6.31,14.08,7.33,14.36,12.81,5.57,12.57,13.6,10.03,13.01,7.68,11.89,7.33,9.05,4.74,7.11,10.58,8.84,12.25,3.96,7.98,10.7,9.47,12.26,11.99,7.12,12.06,6.5,12.02,10.88,10.58,8.64,14,9.09,6.29,7.85,11.3,9.98,11.89,12.52,14.94,7.95,8.73,9.54,4.28,10.07,7.04,12.02,7.47,8.05,10.65,11.34,15.56,11.48,11.05,12.06,3.51,14.15,14.29,11.56,7.72,6.24,7.53,13.51,11.24,11.85,10.23,7.58,12.4,12.13,11.85,12.49,9.8,8.55,11.85,13.56,11.9,7.22,14.77,12.06,11.72,10.49,10.62,6.68,11.01,13.44,15.83,9.71,9.55,14.21,9.29,11.48,7.7,13.44,11.41,5.67,13.28,9.21,10.64,5.46,8.35,7.02,13.17,6.82,7.06,7.35,12.34,5.09,10.6,9.24,11.47,10.92,8.97,10.71,9.15,8.7,7.86,13.49,9.25,11.42,7.46,13.74,13.68,10.03,7.84,3.21,12.27,9.84,4.66,6.87,9.76,10.82,9.72,12.49,14.08,10.43,11.94,9.54,9.44,12.41,10.14,9.99,9.06,14.27,6.6,11.02,12.85,12.63,9.21,12.46,10.46,9.29,10.99,7.9,7.2,7.44,9.13,3.86,11.89,6.53,11.58,13,6.33,12.12,6.54,9.81,13.15,6.13,6.84,4.46,5.23,10.56,13.02,7.8,10.88,6.12,13.46,12.19,9.35,12.63,6.93,12.53,12.51,11.31,6.71,11.93,8.14,11.49,9.51,7.13,5.94,7.62,4.65,6.89,10.98,12.59,11.53,12.3,7.21,12.04,2.89,5.89,14.2,11.5,10.39,8.23,7.54,10.82,10.22,7.9,10.47,10.78,11.79,11.95,10.08,13.29,11.3,12.94,12.47,14.32,8.08,10.75,9.25,13.06,11.13,11,10.48,12.4,10.84,8.48,10.71,5.31,8.38,8.5,13.21,8.38,12.42,11.29,9.15,12.15,11.14,6.04,9.24,4.94,10.24,10.61,11.99,10.09,11.62,8.18,11.38,10.39,13.06,11.48,10.98,8.85,13.07,12.35,12.53,8.74,14.88,9.64,4.7,10.22,7.92,10.43,8.7,7.13,10.68,8.87,13.4,13.8,14.26,4.08,6.45,10.87,10.81,11.06,11.38,9.83,12.56,10.65,13.53,12.32,11.04,4.52,10.33,14.26,9.76,10.8,6.52,11.51,11.36,11,13.29,7.16,3.74,12.91,13.13,8.55,12.37,11.29,11.46,12.39,9.09,9.77,10.81,12.16,12.94,10.55,7.41,9.88,7.55,12.15,14.39,10.41,6.54,9.93,8.07,12.13,11.67,11.59,15.44,11.15,13.86,13.59,10.83,9.83,9.39,11.66,11.12,9.81,2.87,10.75,7.33,12.8,11.06,12.61,10.88,13.63,9.29,11.4,9.89,9.69,10.79,10.27,9.01,10.06,10.86,11.15,8.53,10.52,9.42,11.55,12.22,4.98,7.99,10.02,10.98,9.26,6.68,9.83,5.46,10.44,9.47,12,11.98,12.6,11.85,5.32,11.75,11.09,5.32,15.83,10.56,10.58,10.99,10.12,6.76,11.1,10.08,12.97,3.83,11.54,5.88,10.62,12.37,11.97,6.79,12.74,10.58,6.56,7.53,4.85,4.14,9.43,9.31,5.53,11.84,11.21,11.49,11.02,9.67,9.95,8.87,12.23,10.93,12.51,11.45,6.26,10.76,12.15,14.38,14.06,13.1,8.75,9.17,10.94,12.2,14.92,12.09,13.18,11.38,11.89],[9.53,12.94,8.54,11.61,8,11.59,7.5,9.88,13.62,11.8,13.86,11.12,10.56,13.84,7.49,11.74,12.59,15.2,8.42,11.95,10.32,10.61,7.91,5.19,6.69,10.55,8.09,10.76,10.92,6.13,13.1,9.58,9.32,11.16,6.8,9.46,12.32,12.27,12.11,14.03,7.51,13.42,10.74,9.16,4.95,10.39,12.8,6.53,9.5,12.54,10.19,10.45,11.63,9.65,4.65,7.9,4.86,5.27,13.93,8.7,7.45,8.91,12.28,11.95,4.66,7.88,7.87,11.75,8.04,10.87,13.62,9.11,12.2,9.36,10.97,6.43,14.34,7.42,9.39,12.53,14.19,10.97,7.52,11.4,11.6,11.66,9.07,9.86,12.37,11.1,11.47,7.18,12.5,12.01,14.28,8.54,14.57,13.33,11.85,3.85,11.45,5.25,9.63,8.77,12.09,14.22,11.31,10.96,9.76,12.29,10.75,11.07,11.32,6.43,10.22,8.75,7.22,12.67,9.45,4.54,6.44,9.21,10.37,13.04,10.77,10.52,11.69,7.88,11.08,6.02,14.02,7.23,14.33,13.1,5.62,12.37,13.55,10.18,12.99,7.61,11.89,7.1,8.94,4.71,7.38,10.46,8.75,12.23,3.87,7.77,10.95,9.48,12.31,12,6.99,11.98,6.94,12.23,10.95,10.65,8.25,14.12,10.14,6.25,8.03,11.08,10.61,11.97,12.54,14.89,7.94,8.77,9.66,4.08,9.83,7.02,11.86,8.07,8.31,10.62,11.47,15.48,11.46,10.68,11.95,3.68,14.14,14.2,12.11,7.42,6.19,7.74,13.57,11.31,11.83,10.42,7.81,12.45,12.32,11.74,12.46,9.86,8.19,11.79,13.53,11.76,6.93,14.62,12.3,11.63,10.89,10.29,6.81,11.09,13.53,15.75,9.5,9.55,14.15,9.01,11.1,7.62,13.53,11.48,5.63,13.46,8.96,10.88,5.65,8.43,6.75,13.01,6.97,7.33,7.54,12.25,5.37,10.74,9.25,11.61,10.98,8.72,10.89,8.95,8.55,7.7,13.55,9.34,11.54,7.24,13.68,13.66,9.96,8.16,3.21,12.52,9.98,4.66,6.74,9.65,10.62,9.43,12.43,14.07,10.52,11.82,9.72,9.75,12.32,10.15,9.96,9.27,14.49,6.77,10.84,12.62,12.46,8.91,12.42,10.37,9.52,11.09,7.66,7.85,7.29,8.97,3.81,12,6.61,11.86,13.21,6.3,12.2,6.73,10.01,12.86,6.82,6.78,4.39,5.19,10.62,13.07,8.19,10.99,6.8,13.4,12.15,9.62,12.65,6.8,12.75,12.79,11.24,6.65,11.94,8.23,11.88,9.47,7.15,5.9,7.66,4.7,6.93,11.02,12.65,11.72,12.33,7.08,12,2.91,5.98,14.11,11.55,10.56,8.6,7.5,11,10.44,7.65,10.37,11.08,11.69,11.75,10.08,13.22,11.39,13.24,12.39,14.18,8.23,10.68,8.94,13.13,11.08,10.94,10.68,12.37,10.89,8.62,10.84,5.49,8.51,9.05,13.07,8.32,12.56,11.11,9.29,12.12,10.99,6.13,9.56,4.92,10.56,10.88,12.03,10.22,11.51,8.3,11.35,10.31,12.97,11.61,10.92,8.68,12.87,12.29,12.41,8.67,14.97,9.75,4.62,10.29,7.77,10.43,8.44,7.33,10.83,9.13,13.38,14.05,14.33,4.07,6.36,11.02,10.84,11.09,11.37,9.56,12.37,11.07,13.81,12.27,10.92,4.51,10.17,14.21,9.72,10.86,6.39,11.52,11.67,10.99,13.23,7.02,3.7,12.98,13.05,9.17,12.89,11.24,11.01,12.4,8.92,9.59,10.79,12.21,12.99,10.75,7.21,9.95,7.37,12.22,14.17,10.31,6.34,9.9,8.11,12.12,11.78,11.58,15.38,11.17,13.85,13.55,10.95,9.94,9.46,11.54,11.3,9.84,2.93,10.66,7.49,12.86,10.92,12.19,10.83,13.55,9.49,11.28,9.76,9.77,10.75,10.34,8.98,9.98,10.81,11.09,8.69,10.85,9.47,11.45,12.09,4.95,7.83,9.84,10.82,9.21,6.79,9.85,5.51,10.54,9.59,12.05,11.91,12.57,11.95,5.21,11.86,10.96,5.76,15.81,10.57,10.42,11.06,10.01,6.66,10.99,9.99,13,3.76,11.64,5.86,10.62,12.32,12.04,6.72,12.77,10.38,6.59,7.83,4.95,4.1,9.25,9.17,5.56,11.61,11.01,11.31,11.06,10.26,10.01,8.87,12.08,10.85,12.47,12.19,6.25,10.78,12.01,14.28,13.92,13.05,8.84,9.23,10.83,12.19,14.83,12.18,13.08,11.25,11.85],[8.91,11.77,8.1,10.21,8.71,13.31,7.94,8.54,12.62,11.32,13.3,11.29,11.05,12.8,6.69,9.78,12.22,13.94,9.05,11.04,11.45,9.72,9.65,5.21,7.54,11.02,9.02,11.67,11.45,5.83,12.68,8.1,9.33,11.96,7.5,9.42,11.49,12.57,11.77,14.27,8.87,13.42,9.08,9.01,4.89,11.33,12.16,6.12,7.7,11.5,11.57,9.35,10.98,10,4.65,9.37,4.97,5.35,13.42,8.79,6.86,8.81,13.94,12.06,4.61,9.09,8.33,11.04,9.78,10.37,13.49,9.27,12,10.16,11.25,6.05,13.66,7.09,9.56,12.88,14.06,10.75,11.71,11.46,10.64,12.02,10.38,9.76,12.38,10.93,11.59,9.14,12.82,11.85,15.18,9.1,13.65,13.71,11.92,3.91,11.4,5.25,9.49,7.63,12.19,13.15,10.49,11.4,9.28,12.49,12.12,11.7,12.4,6.32,10.01,9,7.02,12.63,9.28,4.67,7.32,11.1,9.71,12.52,11.15,11.38,12.47,8.04,10.57,6.49,13.64,6.47,14.52,12.16,6,12.48,13.18,9.16,13.11,7.71,12.4,8.11,8.93,4.86,7.27,11.17,10.17,12.08,3.83,8.03,10.17,9.4,12.35,11.43,8.24,12.51,6.9,12.37,10.43,10.48,7.32,13.96,10.22,6.5,9.53,10.81,7.99,11.26,12.9,14.49,8.69,8.68,10.12,4.07,9.79,7.13,11.66,7.43,8.95,11.17,11.23,15.29,11.5,10.56,11.59,3.51,13.46,13.23,10.1,10.73,6.62,7.97,13.41,11.81,11.97,11.71,9.63,12.59,11.9,11.99,12.88,7.77,9.97,11.59,13.2,12.02,7.31,14.79,10.54,11.53,10.74,10.61,8.5,11.37,13.43,15.57,10.78,9.93,13.72,10.67,11.4,8.13,13.48,10.92,5.5,13.09,9.39,11.29,5.28,8.33,6.86,13.06,8.83,7.4,10.92,11.83,5.01,11.07,9.29,11.41,11.06,8.29,11.44,9.53,8.42,8.18,13.16,9.01,10.98,7.11,14.75,13.56,10.83,6.64,3.21,12.47,10.37,4.67,7.65,9.62,11.24,10.39,12.45,14.03,10.56,11.69,9.76,8.94,12.1,10.97,9.63,9.35,13.83,6.69,11.42,12.76,12.94,10.82,12.65,10.34,9.83,11.05,6.55,6.88,7.1,9.39,3.92,11.16,6.17,11.06,12.92,7.31,12.26,7.01,6.76,13.58,6.42,6.99,4.41,5.35,10.35,13.08,8.77,11.03,7.06,13.68,12.39,8.85,12.59,7.15,13.42,12.16,13.19,7.16,12.18,8.36,8.12,10.5,6.26,5.89,7.55,4.79,7.01,11.31,12.53,11.46,12.73,7.03,12.03,2.87,6.05,14.3,11.52,10.28,8.78,8.47,11.46,9.82,8,8.92,8.95,11.27,11.71,10.1,13.72,10.99,13.02,12.3,14.36,8.26,10.88,10.66,12.98,11.4,11.57,10.77,12.44,10.86,9.03,10.72,5.15,9.14,7.87,13.85,8.87,11.4,11.54,9.48,11.72,11.07,5.8,8.86,5.09,9.29,10.46,11.84,10.23,11.94,8.16,11.26,10.17,12.95,10.99,10.99,8.81,13.36,12.21,12.7,6.87,14.59,11.21,4.7,11.22,9.7,10.66,8.14,6.97,10.58,8.51,13.46,13.38,14.25,4.1,7.14,11.17,10.85,10.78,11.39,9.42,12.49,10.94,13.43,12,10.81,4.58,10.26,14.34,10.03,10.84,6.31,11.39,10.94,10.74,13.41,8.46,3.72,12.98,12.84,9.06,11.98,11.05,11.06,12.68,8.63,10.33,10.7,12.39,12.6,10.6,8.52,9.92,8.42,11.96,14.7,9.9,6.49,10.08,7.47,11.59,11.71,11.41,15.45,10.89,13.92,13.48,10.97,10.65,9.99,11.18,7.26,9.37,2.91,10.52,7.37,12.87,10.93,10.84,11.03,13.84,9.48,11.41,9.9,10.16,10.29,10.53,8.91,10.01,10.6,11.46,9.1,10.56,9.51,11.23,12.25,4.93,9.63,9.95,10.93,9.07,9.17,9.8,5.68,10.48,9.44,11.87,11.56,12.52,12.23,5.16,11.35,10.91,5.23,15.52,10.47,10.52,10.95,10.06,6.67,11.38,9.5,12.6,3.77,11.4,6.33,9.97,12.23,11.99,8.85,12.68,10.57,8.18,8.48,4.78,4.15,9.35,9.77,5.95,11.85,11.32,11.26,11.69,8.9,9.89,9.93,12,10.98,12.44,12.69,6.16,10.43,11.93,14.39,13.73,13.07,8.95,8.4,11.14,11.97,15.11,11.95,13.02,11.44,11.48],[9.32,12.54,9.02,11.08,9.73,13,8.28,9.02,12.94,11.75,13.63,11.92,11.51,13.32,7.29,11.16,12.12,13.87,8.86,11.84,12.1,10.28,9.69,5.22,7.34,11.24,9.43,12.15,11.45,6.2,12.89,8.57,9.87,12.28,8.22,9.11,12.03,12.32,11.74,13.97,8.9,13.32,9.27,9.16,5.24,11.82,12.37,6.24,8.81,12.02,11.92,9.89,10.92,11.11,5.01,9.43,4.97,5.6,13.93,9.39,7.18,9.3,13.77,12.13,4.85,9.03,8.7,11.21,10.17,10.17,13.77,9.66,11.87,10.29,11.51,6.51,13.61,7.47,9.82,12.58,13.98,10.73,12.14,11.22,10.59,11.84,10.46,10.09,12.7,10.78,11.48,9.06,12.66,11.75,15.22,9.31,14.08,13.9,11.72,3.92,11.71,6.32,9.5,7.99,12.33,13.55,10.51,11.21,8.99,12.28,12.19,11.78,12.46,6.82,10.19,9.53,7.71,12.66,9.1,4.46,7.24,11.15,9.66,12.41,11.27,11.41,12.31,8.04,10.9,6.79,13.69,6.57,14.39,12.66,5.99,12.48,13.29,9.01,12.94,7.94,12.57,8.02,9.17,4.97,7.16,11.27,10.4,12.23,3.88,8.09,10.67,9.73,12.55,11.22,8.32,12.27,8.85,12.34,10.74,10.78,7.37,13.88,11.2,6.74,9.46,10.82,8.62,11.16,12.76,14.6,9.06,9.05,9.98,4.07,9.93,7.47,11.64,7.66,9,10.88,11.12,15.37,11.65,10.53,11.67,3.5,13.57,13.26,10.79,10.5,6.94,7.97,13.28,11.72,12.1,11.73,9.69,12.48,11.94,11.72,12.69,8.01,9.75,11.7,13.32,12.1,7.2,14.75,10.95,11.11,10.78,10.08,8.68,11.25,13.71,15.64,10.76,9.68,13.79,10.61,11.23,8.34,13.44,10.8,5.63,13.02,9.38,11.19,5.41,8.67,6.82,13.02,8.85,8.24,10.89,11.87,5.15,10.91,9.52,11.37,10.95,8.4,11.45,9.57,8.5,8.24,13.1,8.84,10.87,7.15,14.58,13.37,10.55,6.62,3.36,12.53,10.33,5.18,7.65,9.81,11.2,10.34,12.57,14.12,10.48,11.76,9.68,9,12.19,11.23,9.88,9.84,13.91,6.66,11.42,12.63,12.97,10.76,12.73,10.46,10.33,10.92,6.61,7.3,7.3,9.46,3.89,11.39,6.1,11.15,12.87,7.3,12.2,7.05,6.92,13.48,6.64,7.17,4.45,5.44,10.6,13.03,9.81,11.35,7.25,13.77,12.22,8.74,12.7,7.19,13.52,12.29,12.81,7.35,12.02,8.19,8.52,10.66,6.31,6.02,7.83,4.72,7.33,11.16,12.73,11.45,12.56,7.11,11.88,2.92,5.97,14.32,11.41,10.63,8.91,8.71,11.47,9.8,7.97,9.07,8.99,11.35,11.72,9.89,13.52,10.89,13.45,12.38,14.33,8.16,10.64,10.56,12.92,11.51,11.78,10.82,12.52,10.76,8.88,10.69,5.47,9.06,8.02,13.61,8.54,11.69,11.51,9.4,11.56,11.07,6.08,8.94,5.22,9.79,10.87,11.75,10.19,11.69,8.08,11.38,10.27,12.98,10.97,10.78,8.98,13.28,12.27,12.68,6.76,14.62,11.55,4.79,11.08,9.73,10.81,8.24,6.86,10.58,8.43,13.56,13.77,14.43,4.2,7.06,11.19,10.73,10.65,11.5,9.35,12.41,11.75,13.53,12.1,10.85,4.43,10.3,14.38,9.77,10.72,6.38,11.53,10.98,10.88,13.26,8.38,3.77,12.95,12.64,9.55,12.29,10.87,10.8,12.58,8.72,10.36,10.85,12.27,12.76,10.64,8.34,9.81,8.38,11.92,14.58,10.13,6.49,10.21,7.65,11.71,11.96,11.28,15.49,10.78,14.1,13.67,10.95,10.96,9.87,11.19,7.5,9.56,2.88,10.71,7.33,12.79,10.98,10.6,11.23,13.88,9.49,11.42,9.95,10.06,10.46,10.38,9.43,10.11,10.4,11.55,9.05,10.65,9.2,11.24,12.3,5.01,9.61,9.94,10.96,9.2,9.61,10.06,5.58,10.41,9.39,11.81,11.63,12.61,12.17,5.19,11.64,10.91,5.48,15.61,10.61,10.65,10.89,10.13,6.73,11.49,9.66,12.52,3.78,11.33,6.49,9.79,12.29,11.73,8.75,12.62,10.68,8.07,8.61,4.74,4.19,9.51,9.87,5.94,11.85,11.26,11.25,11.55,9.21,9.68,9.67,11.99,11.04,12.61,13.63,6.32,10.32,12,14.42,13.76,13.14,9.36,8.28,11.18,12.1,15.11,11.88,13.06,11.45,11.61]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>gene_symbol<\/th>\n      <th>L2FC_Cre_Ik_interaction<\/th>\n      <th>padj_Cre_Ik_interaction<\/th>\n      <th>av_NTC_ERT2<\/th>\n      <th>av_NTC_Cre<\/th>\n      <th>av_IkKO_ERT2<\/th>\n      <th>av_IkKO_Cre<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"className":"dt-right","targets":[1,3,4,5,6]}],"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="volano-plot" class="section level2">
<h2><span class="header-section-number">2.6</span> Volano plot</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ikaros-kobcat-gof-de.html#cb7-1"></a>plotdat &lt;-<span class="st"> </span><span class="kw">lapply</span>(contrasts, <span class="cf">function</span>(contrast) {</span>
<span id="cb7-2"><a href="ikaros-kobcat-gof-de.html#cb7-2"></a>  x &lt;-<span class="st"> </span>deanno[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">grep</span>(contrast, <span class="kw">colnames</span>(deanno)))]</span>
<span id="cb7-3"><a href="ikaros-kobcat-gof-de.html#cb7-3"></a>  <span class="kw">colnames</span>(x)[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;L2FC&quot;</span>, <span class="st">&quot;qval&quot;</span>)</span>
<span id="cb7-4"><a href="ikaros-kobcat-gof-de.html#cb7-4"></a>  x<span class="op">$</span>col &lt;-<span class="st"> &quot;B&quot;</span></span>
<span id="cb7-5"><a href="ikaros-kobcat-gof-de.html#cb7-5"></a>  x[<span class="kw">which</span>(x<span class="op">$</span>qval <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span>x<span class="op">$</span>L2FC <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.58</span>),]<span class="op">$</span>col &lt;-<span class="st"> &quot;A&quot;</span></span>
<span id="cb7-6"><a href="ikaros-kobcat-gof-de.html#cb7-6"></a>  x[<span class="kw">which</span>(x<span class="op">$</span>qval <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">&amp;</span><span class="st"> </span>x<span class="op">$</span>L2FC <span class="op">&lt;</span><span class="st"> </span><span class="fl">-0.58</span>),]<span class="op">$</span>col &lt;-<span class="st"> &quot;C&quot;</span></span>
<span id="cb7-7"><a href="ikaros-kobcat-gof-de.html#cb7-7"></a>  <span class="cf">if</span> (<span class="kw">any</span>(x<span class="op">$</span>qval <span class="op">&lt;</span><span class="st"> </span><span class="fl">1e-100</span>, <span class="dt">na.rm =</span> T)) x[<span class="kw">which</span>(x<span class="op">$</span>qval<span class="op">&lt;</span><span class="fl">1e-100</span>),]<span class="op">$</span>qval &lt;-<span class="st"> </span><span class="fl">1e-100</span></span>
<span id="cb7-8"><a href="ikaros-kobcat-gof-de.html#cb7-8"></a>  topg &lt;-<span class="st"> </span><span class="kw">top_n</span>(x, <span class="dv">50</span>, <span class="op">-</span>qval)<span class="op">$</span>gene_symbol</span>
<span id="cb7-9"><a href="ikaros-kobcat-gof-de.html#cb7-9"></a>  x<span class="op">$</span>label &lt;-<span class="st"> </span><span class="kw">ifelse</span>(x<span class="op">$</span>gene_symbol <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(topg) <span class="op">&amp;</span><span class="st"> </span>x<span class="op">$</span>qval <span class="op">&lt;</span><span class="st"> </span><span class="fl">1e-10</span>,</span>
<span id="cb7-10"><a href="ikaros-kobcat-gof-de.html#cb7-10"></a>                    x<span class="op">$</span>gene_symbol, <span class="st">&quot;&quot;</span>)</span>
<span id="cb7-11"><a href="ikaros-kobcat-gof-de.html#cb7-11"></a>  x<span class="op">$</span>comparison &lt;-<span class="st"> </span>contrast</span>
<span id="cb7-12"><a href="ikaros-kobcat-gof-de.html#cb7-12"></a>  <span class="kw">return</span>(x)</span>
<span id="cb7-13"><a href="ikaros-kobcat-gof-de.html#cb7-13"></a>}) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>()</span>
<span id="cb7-14"><a href="ikaros-kobcat-gof-de.html#cb7-14"></a>(p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(plotdat, <span class="kw">aes</span>(<span class="dt">x =</span> L2FC, <span class="dt">y =</span> <span class="op">-</span><span class="kw">log10</span>(qval))) <span class="op">+</span></span>
<span id="cb7-15"><a href="ikaros-kobcat-gof-de.html#cb7-15"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="op">-</span><span class="kw">log10</span>(<span class="fl">0.01</span>), <span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">lty=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb7-16"><a href="ikaros-kobcat-gof-de.html#cb7-16"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">lty=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb7-17"><a href="ikaros-kobcat-gof-de.html#cb7-17"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col=</span>col), <span class="dt">alpha =</span> <span class="fl">.5</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb7-18"><a href="ikaros-kobcat-gof-de.html#cb7-18"></a><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> label)) <span class="op">+</span></span>
<span id="cb7-19"><a href="ikaros-kobcat-gof-de.html#cb7-19"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>comparison, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></span>
<span id="cb7-20"><a href="ikaros-kobcat-gof-de.html#cb7-20"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;firebrick4&quot;</span>,<span class="st">&quot;grey40&quot;</span>,<span class="st">&quot;steelblue4&quot;</span>)) <span class="op">+</span></span>
<span id="cb7-21"><a href="ikaros-kobcat-gof-de.html#cb7-21"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Fold change (log2)&quot;</span>) <span class="op">+</span></span>
<span id="cb7-22"><a href="ikaros-kobcat-gof-de.html#cb7-22"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Significance (-log10 p-value)&quot;</span>) <span class="op">+</span></span>
<span id="cb7-23"><a href="ikaros-kobcat-gof-de.html#cb7-23"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;Arial&quot;</span>),</span>
<span id="cb7-24"><a href="ikaros-kobcat-gof-de.html#cb7-24"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;Arial&quot;</span>),</span>
<span id="cb7-25"><a href="ikaros-kobcat-gof-de.html#cb7-25"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb7-26"><a href="ikaros-kobcat-gof-de.html#cb7-26"></a>        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb7-27"><a href="ikaros-kobcat-gof-de.html#cb7-27"></a>        <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>),</span>
<span id="cb7-28"><a href="ikaros-kobcat-gof-de.html#cb7-28"></a>        <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb7-29"><a href="ikaros-kobcat-gof-de.html#cb7-29"></a>        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;Arial&quot;</span>), </span>
<span id="cb7-30"><a href="ikaros-kobcat-gof-de.html#cb7-30"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>))</span></code></pre></div>
<p><img src="2020-09-29_IkKO_GOF_DE_files/figure-html/ikgof_volcano-1.png" width="768" /></p>
</div>
<div id="full-gsea" class="section level2">
<h2><span class="header-section-number">2.7</span> Full GSEA</h2>
<p>Note: This analysis was run on all REACTOME, KEGG, MSigDB Hallmark, and WIKIPATHWAY database gene sets (with some minor filtering for irrelevant sets). This is useful for data exploration but will inflate q-value/padj simply due to the large number of tests performed, hence these results should be used to identify potentially interesting pathways before performing more selective enrichment testing for more appropriate statistical values.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="ikaros-kobcat-gof-de.html#cb8-1"></a><span class="kw">library</span>(msigdbr)</span>
<span id="cb8-2"><a href="ikaros-kobcat-gof-de.html#cb8-2"></a><span class="kw">library</span>(fgsea)</span>
<span id="cb8-3"><a href="ikaros-kobcat-gof-de.html#cb8-3"></a>msig &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">msigdbr</span>(<span class="dt">species =</span> <span class="st">&quot;Mus musculus&quot;</span>, <span class="dt">category =</span> <span class="st">&quot;H&quot;</span>),</span>
<span id="cb8-4"><a href="ikaros-kobcat-gof-de.html#cb8-4"></a>              <span class="kw">msigdbr</span>(<span class="dt">species =</span> <span class="st">&quot;Mus musculus&quot;</span>, <span class="dt">category =</span> <span class="st">&quot;C2&quot;</span>, <span class="dt">subcategory =</span> <span class="st">&quot;CP:REACTOME&quot;</span>),</span>
<span id="cb8-5"><a href="ikaros-kobcat-gof-de.html#cb8-5"></a>              <span class="kw">msigdbr</span>(<span class="dt">species =</span> <span class="st">&quot;Mus musculus&quot;</span>, <span class="dt">category =</span> <span class="st">&quot;C2&quot;</span>, <span class="dt">subcategory =</span> <span class="st">&quot;CP:KEGG&quot;</span>),</span>
<span id="cb8-6"><a href="ikaros-kobcat-gof-de.html#cb8-6"></a>              <span class="kw">msigdbr</span>(<span class="dt">species =</span> <span class="st">&quot;Mus musculus&quot;</span>, <span class="dt">category =</span> <span class="st">&quot;C2&quot;</span>, <span class="dt">subcategory =</span> <span class="st">&quot;CP:WIKIPATHWAYS&quot;</span>)) </span>
<span id="cb8-7"><a href="ikaros-kobcat-gof-de.html#cb8-7"></a>gs &lt;-<span class="st"> </span><span class="kw">split</span>(msig<span class="op">$</span>gene_symbol, msig<span class="op">$</span>gs_name)</span>
<span id="cb8-8"><a href="ikaros-kobcat-gof-de.html#cb8-8"></a>internal_gs &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;../../resources/internal_genesets_Mm.rds&quot;</span>)</span>
<span id="cb8-9"><a href="ikaros-kobcat-gof-de.html#cb8-9"></a>gs &lt;-<span class="st"> </span><span class="kw">c</span>(gs, internal_gs)</span>
<span id="cb8-10"><a href="ikaros-kobcat-gof-de.html#cb8-10"></a>gs &lt;-<span class="st"> </span>gs[<span class="op">!</span><span class="kw">grepl</span>(<span class="kw">paste0</span>(<span class="st">&quot;sperm|xeno|graft|naba|spinal|neuro|sclerosis&quot;</span>,</span>
<span id="cb8-11"><a href="ikaros-kobcat-gof-de.html#cb8-11"></a>                       <span class="st">&quot;|tion_of_hscs|photo|leish|diabetes|lupus|ebola&quot;</span>,</span>
<span id="cb8-12"><a href="ikaros-kobcat-gof-de.html#cb8-12"></a>                       <span class="st">&quot;|staph|syndrome|myo|nicotin|asthma|thyroid_stim&quot;</span>,</span>
<span id="cb8-13"><a href="ikaros-kobcat-gof-de.html#cb8-13"></a>                       <span class="st">&quot;|gastrin|alcohol|nutrient|carcinoma|muscle_contr&quot;</span>,</span>
<span id="cb8-14"><a href="ikaros-kobcat-gof-de.html#cb8-14"></a>                       <span class="st">&quot;|metapathway|amyloid|fusion_mutants|circadian&quot;</span>),</span>
<span id="cb8-15"><a href="ikaros-kobcat-gof-de.html#cb8-15"></a>                <span class="kw">names</span>(gs), <span class="dt">ignore.case =</span> T)]</span>
<span id="cb8-16"><a href="ikaros-kobcat-gof-de.html#cb8-16"></a>gl &lt;-<span class="st"> </span><span class="kw">lapply</span>(contrasts, <span class="cf">function</span>(contrast) {</span>
<span id="cb8-17"><a href="ikaros-kobcat-gof-de.html#cb8-17"></a>  tmp &lt;-<span class="st"> </span>deanno[,<span class="kw">grep</span>(contrast, <span class="kw">colnames</span>(deanno))]</span>
<span id="cb8-18"><a href="ikaros-kobcat-gof-de.html#cb8-18"></a>  <span class="kw">colnames</span>(tmp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;L2FC&quot;</span>,<span class="st">&quot;qval&quot;</span>)</span>
<span id="cb8-19"><a href="ikaros-kobcat-gof-de.html#cb8-19"></a>  tmp &lt;-<span class="st"> </span>(tmp<span class="op">$</span>L2FC <span class="op">*</span><span class="st"> </span>(<span class="op">-</span><span class="kw">log10</span>(tmp<span class="op">$</span>qval<span class="fl">+1e-50</span>)<span class="op">/</span><span class="dv">10</span>))</span>
<span id="cb8-20"><a href="ikaros-kobcat-gof-de.html#cb8-20"></a>  <span class="kw">names</span>(tmp) &lt;-<span class="st"> </span>deanno<span class="op">$</span>gene_symbol</span>
<span id="cb8-21"><a href="ikaros-kobcat-gof-de.html#cb8-21"></a>  tmp &lt;-<span class="st"> </span>tmp[<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">names</span>(tmp)) <span class="op">&amp;</span><span class="st"> </span><span class="kw">names</span>(tmp) <span class="op">!=</span><span class="st"> &quot;&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(tmp) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.finite</span>(tmp)]</span>
<span id="cb8-22"><a href="ikaros-kobcat-gof-de.html#cb8-22"></a>  tmp &lt;-<span class="st"> </span>tmp[<span class="kw">order</span>(<span class="op">-</span>tmp)]</span>
<span id="cb8-23"><a href="ikaros-kobcat-gof-de.html#cb8-23"></a>  tmp[<span class="op">!</span><span class="kw">duplicated</span>(<span class="kw">names</span>(tmp))]</span>
<span id="cb8-24"><a href="ikaros-kobcat-gof-de.html#cb8-24"></a>})</span>
<span id="cb8-25"><a href="ikaros-kobcat-gof-de.html#cb8-25"></a>gseres &lt;-<span class="st"> </span><span class="kw">lapply</span>(gl, <span class="cf">function</span>(x) {</span>
<span id="cb8-26"><a href="ikaros-kobcat-gof-de.html#cb8-26"></a>  <span class="kw">fgseaSimple</span>(<span class="dt">pathways =</span> gs, <span class="dt">stats =</span> x, </span>
<span id="cb8-27"><a href="ikaros-kobcat-gof-de.html#cb8-27"></a>              <span class="dt">nperm =</span> <span class="dv">1000</span>, <span class="dt">minSize =</span> <span class="dv">10</span>, <span class="dt">maxSize =</span> <span class="dv">500</span>) <span class="op">%&gt;%</span></span>
<span id="cb8-28"><a href="ikaros-kobcat-gof-de.html#cb8-28"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">lengths</span>(leadingEdge) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span></span>
<span id="cb8-29"><a href="ikaros-kobcat-gof-de.html#cb8-29"></a><span class="st">    </span><span class="kw">arrange</span>(pval)</span>
<span id="cb8-30"><a href="ikaros-kobcat-gof-de.html#cb8-30"></a>})</span>
<span id="cb8-31"><a href="ikaros-kobcat-gof-de.html#cb8-31"></a>wb &lt;-<span class="st"> </span><span class="kw">createWorkbook</span>()</span>
<span id="cb8-32"><a href="ikaros-kobcat-gof-de.html#cb8-32"></a><span class="kw">lapply</span>(contrasts, <span class="cf">function</span>(contrast) {</span>
<span id="cb8-33"><a href="ikaros-kobcat-gof-de.html#cb8-33"></a>  gse &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(gseres[[contrast]])</span>
<span id="cb8-34"><a href="ikaros-kobcat-gof-de.html#cb8-34"></a>  <span class="kw">addWorksheet</span>(wb, <span class="dt">sheetName =</span> contrast)</span>
<span id="cb8-35"><a href="ikaros-kobcat-gof-de.html#cb8-35"></a>  <span class="kw">writeData</span>(wb, gse, <span class="dt">sheet =</span> contrast, <span class="dt">rowNames =</span> F)</span>
<span id="cb8-36"><a href="ikaros-kobcat-gof-de.html#cb8-36"></a>  <span class="kw">freezePane</span>(wb, <span class="dt">sheet =</span> contrast, <span class="dt">firstRow =</span> <span class="ot">TRUE</span>, <span class="dt">firstCol =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-37"><a href="ikaros-kobcat-gof-de.html#cb8-37"></a>  <span class="kw">return</span>(<span class="ot">NULL</span>)</span>
<span id="cb8-38"><a href="ikaros-kobcat-gof-de.html#cb8-38"></a>})</span></code></pre></div>
<pre><code>## $NTC_Cre_vs_NTC_ERT2
## NULL
## 
## $Ik_Cre_vs_Ik_ERT2
## NULL
## 
## $Ik_ERT2_vs_NTC_ERT2
## NULL
## 
## $Ik_Cre_vs_NTC_Cre
## NULL
## 
## $Cre_Ik_interaction
## NULL</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="ikaros-kobcat-gof-de.html#cb10-1"></a><span class="kw">saveWorkbook</span>(wb, <span class="st">&quot;../results/IkKO_bcatGOF_DE_fullGSEA.2021-03-05.xlsx&quot;</span>, <span class="dt">overwrite =</span> T)</span>
<span id="cb10-2"><a href="ikaros-kobcat-gof-de.html#cb10-2"></a><span class="kw">lapply</span>(contrasts, <span class="cf">function</span>(x) {</span>
<span id="cb10-3"><a href="ikaros-kobcat-gof-de.html#cb10-3"></a>  tmp &lt;-<span class="st"> </span>gseres[[x]] <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(pval <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(pathway, NES)</span>
<span id="cb10-4"><a href="ikaros-kobcat-gof-de.html#cb10-4"></a>  tmp[,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">round</span>(tmp[,<span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb10-5"><a href="ikaros-kobcat-gof-de.html#cb10-5"></a>  <span class="kw">colnames</span>(tmp)[<span class="dv">2</span>] &lt;-<span class="st"> </span>x</span>
<span id="cb10-6"><a href="ikaros-kobcat-gof-de.html#cb10-6"></a>  <span class="kw">return</span>(tmp) }) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-7"><a href="ikaros-kobcat-gof-de.html#cb10-7"></a><span class="st">  </span><span class="kw">Reduce</span>(<span class="dt">f =</span> <span class="cf">function</span>(x,y) { <span class="kw">merge</span>(x, y, <span class="dt">by=</span><span class="st">&quot;pathway&quot;</span>) }) <span class="op">%&gt;%</span></span>
<span id="cb10-8"><a href="ikaros-kobcat-gof-de.html#cb10-8"></a><span class="st">  </span><span class="kw">arrange</span>(Cre_Ik_interaction) <span class="op">%&gt;%</span></span>
<span id="cb10-9"><a href="ikaros-kobcat-gof-de.html#cb10-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pathway =</span> <span class="kw">ifelse</span>(pathway <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(internal_gs), pathway,</span>
<span id="cb10-10"><a href="ikaros-kobcat-gof-de.html#cb10-10"></a>                          <span class="kw">paste0</span>(<span class="st">&#39;&lt;a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/&#39;</span>, </span>
<span id="cb10-11"><a href="ikaros-kobcat-gof-de.html#cb10-11"></a>                                 pathway, <span class="st">&#39;.html&gt;&#39;</span>, <span class="kw">substr</span>(pathway, <span class="dv">0</span>,<span class="dv">30</span>), <span class="st">&#39;&lt;/a&gt;&#39;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb10-12"><a href="ikaros-kobcat-gof-de.html#cb10-12"></a><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">escape  =</span> F, <span class="dt">rownames =</span> F,</span>
<span id="cb10-13"><a href="ikaros-kobcat-gof-de.html#cb10-13"></a>                <span class="dt">options =</span> <span class="kw">list</span>(</span>
<span id="cb10-14"><a href="ikaros-kobcat-gof-de.html#cb10-14"></a>                  <span class="dt">scrollX =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<div id="htmlwidget-406b731f38aa99d730cc" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-406b731f38aa99d730cc">{"x":{"filter":"none","data":[["<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_REGULATION_OF_INSULIN_SECRETION.html>REACTOME_REGULATION_OF_INSULIN<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_PATHWAYS_REGULATING_HIPPO_SIGNALING.html>WP_PATHWAYS_REGULATING_HIPPO_S<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_PPAR_SIGNALING_PATHWAY.html>WP_PPAR_SIGNALING_PATHWAY<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/KEGG_PPAR_SIGNALING_PATHWAY.html>KEGG_PPAR_SIGNALING_PATHWAY<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_MITOCHONDRIAL_PROTEIN_IMPORT.html>REACTOME_MITOCHONDRIAL_PROTEIN<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_SIGNALING_BY_NUCLEAR_RECEPTORS.html>REACTOME_SIGNALING_BY_NUCLEAR_<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/KEGG_CYTOKINE_CYTOKINE_RECEPTOR_INTERACTION.html>KEGG_CYTOKINE_CYTOKINE_RECEPTO<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_C_TYPE_LECTIN_RECEPTORS_CLRS_.html>REACTOME_C_TYPE_LECTIN_RECEPTO<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_TGFBETA_RECEPTOR_SIGNALING.html>WP_TGFBETA_RECEPTOR_SIGNALING<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_HIV_INFECTION.html>REACTOME_HIV_INFECTION<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_UREA_CYCLE_AND_METABOLISM_OF_AMINO_GROUPS.html>WP_UREA_CYCLE_AND_METABOLISM_O<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_ESR_MEDIATED_SIGNALING.html>REACTOME_ESR_MEDIATED_SIGNALIN<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_TCF_DEPENDENT_SIGNALING_IN_RESPONSE_TO_WNT.html>REACTOME_TCF_DEPENDENT_SIGNALI<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_SIGNALING_BY_WNT.html>REACTOME_SIGNALING_BY_WNT<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_SIGNALING_BY_THE_B_CELL_RECEPTOR_BCR_.html>REACTOME_SIGNALING_BY_THE_B_CE<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_CELL_SURFACE_INTERACTIONS_AT_THE_VASCULAR_WALL.html>REACTOME_CELL_SURFACE_INTERACT<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/KEGG_NATURAL_KILLER_CELL_MEDIATED_CYTOTOXICITY.html>KEGG_NATURAL_KILLER_CELL_MEDIA<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/KEGG_FC_GAMMA_R_MEDIATED_PHAGOCYTOSIS.html>KEGG_FC_GAMMA_R_MEDIATED_PHAGO<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_PLATELET_ACTIVATION_SIGNALING_AND_AGGREGATION.html>REACTOME_PLATELET_ACTIVATION_S<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_APOPTOSIS.html>HALLMARK_APOPTOSIS<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/KEGG_PANCREATIC_CANCER.html>KEGG_PANCREATIC_CANCER<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_FC_EPSILON_RECEPTOR_FCERI_SIGNALING.html>REACTOME_FC_EPSILON_RECEPTOR_F<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/KEGG_T_CELL_RECEPTOR_SIGNALING_PATHWAY.html>KEGG_T_CELL_RECEPTOR_SIGNALING<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_INTERFERON_GAMMA_RESPONSE.html>HALLMARK_INTERFERON_GAMMA_RESP<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_CLEC7A_DECTIN_1_SIGNALING.html>REACTOME_CLEC7A_DECTIN_1_SIGNA<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_APICAL_JUNCTION.html>HALLMARK_APICAL_JUNCTION<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_REGULATION_OF_TOLLLIKE_RECEPTOR_SIGNALING_PATHWAY.html>WP_REGULATION_OF_TOLLLIKE_RECE<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_MYC_TARGETS_V1.html>HALLMARK_MYC_TARGETS_V1<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_ESTROGEN_RESPONSE_LATE.html>HALLMARK_ESTROGEN_RESPONSE_LAT<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_INTERLEUKIN_2_FAMILY_SIGNALING.html>REACTOME_INTERLEUKIN_2_FAMILY_<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_TYPE_II_INTERFERON_SIGNALING_IFNG.html>WP_TYPE_II_INTERFERON_SIGNALIN<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_MYC_TARGETS_V2.html>HALLMARK_MYC_TARGETS_V2<\/a>","Cosgun_Bcatenin_GOF_DN","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_UNFOLDED_PROTEIN_RESPONSE.html>HALLMARK_UNFOLDED_PROTEIN_RESP<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_WNT_SIGNALING.html>WP_WNT_SIGNALING<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_IMMUNOREGULATORY_INTERACTIONS_BETWEEN_A_LYMPHOID_AND_A_NON_LYMPHOID_CELL.html>REACTOME_IMMUNOREGULATORY_INTE<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_NOTCH1_INTRACELLULAR_DOMAIN_REGULATES_TRANSCRIPTION.html>REACTOME_NOTCH1_INTRACELLULAR_<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_CHOLESTEROL_BIOSYNTHESIS_PATHWAY.html>WP_CHOLESTEROL_BIOSYNTHESIS_PA<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_TGFBETA_RECEPTOR_SIGNALLING_IN_SKELETAL_DYSPLASIAS.html>WP_TGFBETA_RECEPTOR_SIGNALLING<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_LNCRNA_INVOLVEMENT_IN_CANONICAL_WNT_SIGNALING_AND_COLORECTAL_CANCER.html>WP_LNCRNA_INVOLVEMENT_IN_CANON<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/KEGG_WNT_SIGNALING_PATHWAY.html>KEGG_WNT_SIGNALING_PATHWAY<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_HEME_METABOLISM.html>HALLMARK_HEME_METABOLISM<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_WNT_BETA_CATENIN_SIGNALING.html>HALLMARK_WNT_BETA_CATENIN_SIGN<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/REACTOME_PHASE_II_CONJUGATION_OF_COMPOUNDS.html>REACTOME_PHASE_II_CONJUGATION_<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_IL2_SIGNALING_PATHWAY.html>WP_IL2_SIGNALING_PATHWAY<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/HALLMARK_IL6_JAK_STAT3_SIGNALING.html>HALLMARK_IL6_JAK_STAT3_SIGNALI<\/a>","<a href=https://www.gsea-msigdb.org/gsea/msigdb/cards/WP_WNT_SIGNALING_PATHWAY_AND_PLURIPOTENCY.html>WP_WNT_SIGNALING_PATHWAY_AND_P<\/a>"],[1.264,1.313,1.118,1.13,-1.488,-1.056,1.01,1.211,-1.026,1.197,-1.422,-1.237,1.027,1.051,1.06,1.083,1.384,1.135,1.345,1.083,1.042,1.176,1.375,1.243,1.239,1.045,1.203,-1.644,1.009,1.31,1.057,-1.643,-1.744,-1.621,1.131,1.052,-1.335,-1.272,-1.022,1.182,1.085,-0.965,1.07,-1.182,1.033,1.238,1.094],[1.091,1.293,1.204,1.222,-1.293,-0.938,1.3,1.217,1.166,1.263,-1.434,-1.094,1.111,1.119,1.217,1.163,1.286,1.171,1.114,1.102,1.206,1.172,1.285,1.106,1.24,1.223,1.213,-1.359,1.205,1.302,1.236,-1.651,-1.79,-1.315,1.231,1.329,-1.426,1.081,1.25,1.241,1.238,1.124,1.268,1.206,1.067,1.228,1.252],[1.203,1.036,1.132,1.237,1.023,1.141,-1.191,-1.229,1.04,-1.46,1.24,1.067,1.118,1.174,-1.523,-1.069,-1.24,-1.07,1.065,1.065,1,-1.203,-1.232,-1.216,-1.186,1.143,-1.343,1.028,1.057,-1.63,-1.216,1.33,1.195,1.071,1.104,-1.319,1.281,-1.33,1.044,1.082,1.159,1.153,1.174,1.171,-1.415,-1.47,1.044],[1.239,1.158,1.061,1.181,1.143,1.253,-1.054,-1.265,1.059,-1.186,1.235,1.204,1.195,1.221,-1.597,-1.017,-1.311,-0.977,1.097,1.104,1.007,-1.236,-1.031,-1.293,-1.167,1.206,-1.31,1.222,1.137,-1.569,-1.241,1.344,1.265,1.168,1.219,-1.287,1.228,-1.216,1.07,1.19,1.245,1.191,1.383,1.227,-1.352,-1.452,1.139],[-0.943,1.025,1.038,1.039,1.041,1.058,1.059,1.061,1.078,1.089,1.09,1.096,1.097,1.099,1.101,1.102,1.113,1.122,1.138,1.148,1.153,1.155,1.179,1.196,1.205,1.214,1.232,1.282,1.287,1.312,1.326,1.331,1.339,1.349,1.35,1.368,1.37,1.373,1.375,1.381,1.385,1.396,1.401,1.407,1.416,1.427,1.432]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>pathway<\/th>\n      <th>NTC_Cre_vs_NTC_ERT2<\/th>\n      <th>Ik_Cre_vs_Ik_ERT2<\/th>\n      <th>Ik_ERT2_vs_NTC_ERT2<\/th>\n      <th>Ik_Cre_vs_NTC_Cre<\/th>\n      <th>Cre_Ik_interaction<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="select-gsea" class="section level2">
<h2><span class="header-section-number">2.8</span> Select GSEA</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="ikaros-kobcat-gof-de.html#cb11-1"></a>poi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;HALLMARK_MYC_TARGETS_V1&quot;</span>,<span class="st">&quot;HALLMARK_MYC_TARGETS_V2&quot;</span>,</span>
<span id="cb11-2"><a href="ikaros-kobcat-gof-de.html#cb11-2"></a>         <span class="st">&quot;REACTOME_DEATH_RECEPTOR_SIGNALLING&quot;</span>,</span>
<span id="cb11-3"><a href="ikaros-kobcat-gof-de.html#cb11-3"></a>         <span class="st">&quot;REACTOME_MITOTIC_G1_PHASE_AND_G1_S_TRANSITION&quot;</span>,</span>
<span id="cb11-4"><a href="ikaros-kobcat-gof-de.html#cb11-4"></a>         <span class="st">&quot;HALLMARK_KRAS_SIGNALING_UP&quot;</span>,</span>
<span id="cb11-5"><a href="ikaros-kobcat-gof-de.html#cb11-5"></a>         <span class="st">&quot;REACTOME_SIGNALING_BY_NOTCH&quot;</span>,</span>
<span id="cb11-6"><a href="ikaros-kobcat-gof-de.html#cb11-6"></a>         <span class="st">&quot;Cosgun_Bcatenin_GOF_UP&quot;</span>,</span>
<span id="cb11-7"><a href="ikaros-kobcat-gof-de.html#cb11-7"></a>         <span class="st">&quot;Schjerven_Ikzf1_KO_UP&quot;</span>,</span>
<span id="cb11-8"><a href="ikaros-kobcat-gof-de.html#cb11-8"></a>         <span class="st">&quot;GSE73238_CD8_TcfLefDKO_UP&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="ikaros-kobcat-gof-de.html#cb12-1"></a>gsub &lt;-<span class="st"> </span>gs[<span class="kw">names</span>(gs) <span class="op">%in%</span><span class="st"> </span>poi]</span>
<span id="cb12-2"><a href="ikaros-kobcat-gof-de.html#cb12-2"></a>gseres &lt;-<span class="st"> </span><span class="kw">lapply</span>(gl, <span class="cf">function</span>(x) {</span>
<span id="cb12-3"><a href="ikaros-kobcat-gof-de.html#cb12-3"></a>  <span class="kw">fgseaSimple</span>(<span class="dt">pathways =</span> gsub, <span class="dt">stats =</span> x, </span>
<span id="cb12-4"><a href="ikaros-kobcat-gof-de.html#cb12-4"></a>              <span class="dt">nperm =</span> <span class="dv">10000</span>, <span class="dt">minSize =</span> <span class="dv">10</span>, <span class="dt">maxSize =</span> <span class="dv">500</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-5"><a href="ikaros-kobcat-gof-de.html#cb12-5"></a><span class="st">    </span><span class="kw">arrange</span>(pval)</span>
<span id="cb12-6"><a href="ikaros-kobcat-gof-de.html#cb12-6"></a>})</span>
<span id="cb12-7"><a href="ikaros-kobcat-gof-de.html#cb12-7"></a><span class="kw">saveRDS</span>(gseres, <span class="st">&quot;../processed_data/RNAseq/IkKO_bcatGOF_DE_subGSEA.2021-03-05.rds&quot;</span>)</span>
<span id="cb12-8"><a href="ikaros-kobcat-gof-de.html#cb12-8"></a>wb &lt;-<span class="st"> </span><span class="kw">createWorkbook</span>()</span>
<span id="cb12-9"><a href="ikaros-kobcat-gof-de.html#cb12-9"></a><span class="kw">lapply</span>(<span class="kw">names</span>(gseres), <span class="cf">function</span>(contrast) {</span>
<span id="cb12-10"><a href="ikaros-kobcat-gof-de.html#cb12-10"></a>  gse &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(gseres[[contrast]])</span>
<span id="cb12-11"><a href="ikaros-kobcat-gof-de.html#cb12-11"></a>  <span class="kw">addWorksheet</span>(wb, <span class="dt">sheetName =</span> contrast)</span>
<span id="cb12-12"><a href="ikaros-kobcat-gof-de.html#cb12-12"></a>  <span class="kw">writeData</span>(wb, gse, <span class="dt">sheet =</span> contrast, <span class="dt">rowNames =</span> F)</span>
<span id="cb12-13"><a href="ikaros-kobcat-gof-de.html#cb12-13"></a>  <span class="kw">freezePane</span>(wb, <span class="dt">sheet =</span> contrast, <span class="dt">firstRow =</span> <span class="ot">TRUE</span>, <span class="dt">firstCol =</span> <span class="ot">TRUE</span>) </span>
<span id="cb12-14"><a href="ikaros-kobcat-gof-de.html#cb12-14"></a>  <span class="kw">return</span>(gse)</span>
<span id="cb12-15"><a href="ikaros-kobcat-gof-de.html#cb12-15"></a>})</span>
<span id="cb12-16"><a href="ikaros-kobcat-gof-de.html#cb12-16"></a><span class="kw">saveWorkbook</span>(wb, <span class="st">&quot;../results/IkKO_bcatGOF_DE_subGSEA.2021-03-05.xlsx&quot;</span>, <span class="dt">overwrite =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="ikaros-kobcat-gof-de.html#cb13-1"></a>gseres &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;../processed_data/RNAseq/IkKO_bcatGOF_DE_subGSEA.2021-03-05.rds&quot;</span>)</span>
<span id="cb13-2"><a href="ikaros-kobcat-gof-de.html#cb13-2"></a>int_levels &lt;-<span class="st"> </span>gseres<span class="op">$</span>Cre_Ik_interaction <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="op">-</span>NES) <span class="op">%&gt;%</span><span class="st"> </span>.<span class="op">$</span>pathway</span>
<span id="cb13-3"><a href="ikaros-kobcat-gof-de.html#cb13-3"></a><span class="kw">lapply</span>(<span class="kw">names</span>(gseres), <span class="cf">function</span>(x) {</span>
<span id="cb13-4"><a href="ikaros-kobcat-gof-de.html#cb13-4"></a>  gseres[[x]] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-5"><a href="ikaros-kobcat-gof-de.html#cb13-5"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">pvaltxt =</span> <span class="kw">ifelse</span>(padj <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.001</span>, <span class="st">&quot;***&quot;</span>, </span>
<span id="cb13-6"><a href="ikaros-kobcat-gof-de.html#cb13-6"></a>                            <span class="kw">ifelse</span>(padj <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>, <span class="st">&quot;**&quot;</span>,</span>
<span id="cb13-7"><a href="ikaros-kobcat-gof-de.html#cb13-7"></a>                              <span class="kw">ifelse</span>(padj <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>, <span class="st">&quot;*&quot;</span>, <span class="st">&quot;-&quot;</span>))),</span>
<span id="cb13-8"><a href="ikaros-kobcat-gof-de.html#cb13-8"></a>           <span class="dt">cond =</span> x, </span>
<span id="cb13-9"><a href="ikaros-kobcat-gof-de.html#cb13-9"></a>           <span class="dt">score =</span> <span class="op">-</span><span class="kw">log10</span>(padj)<span class="op">*</span>NES) <span class="op">%&gt;%</span></span>
<span id="cb13-10"><a href="ikaros-kobcat-gof-de.html#cb13-10"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">select</span>(pathway, score, pvaltxt, cond) }) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-11"><a href="ikaros-kobcat-gof-de.html#cb13-11"></a><span class="st">  </span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-12"><a href="ikaros-kobcat-gof-de.html#cb13-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cond=</span><span class="kw">factor</span>(cond, <span class="dt">levels=</span><span class="kw">unique</span>(cond)),</span>
<span id="cb13-13"><a href="ikaros-kobcat-gof-de.html#cb13-13"></a>         <span class="dt">pathway =</span> <span class="kw">factor</span>(pathway, <span class="dt">levels=</span>int_levels)) <span class="op">%&gt;%</span></span>
<span id="cb13-14"><a href="ikaros-kobcat-gof-de.html#cb13-14"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>cond, <span class="dt">y=</span>pathway, <span class="dt">fill=</span>score, <span class="dt">label=</span>pvaltxt)) <span class="op">+</span></span>
<span id="cb13-15"><a href="ikaros-kobcat-gof-de.html#cb13-15"></a><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></span>
<span id="cb13-16"><a href="ikaros-kobcat-gof-de.html#cb13-16"></a><span class="st">  </span><span class="kw">geom_text</span>() <span class="op">+</span></span>
<span id="cb13-17"><a href="ikaros-kobcat-gof-de.html#cb13-17"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">name=</span><span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb13-18"><a href="ikaros-kobcat-gof-de.html#cb13-18"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">name=</span><span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-19"><a href="ikaros-kobcat-gof-de.html#cb13-19"></a><span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low=</span><span class="st">&quot;steelblue4&quot;</span>, <span class="dt">mid=</span><span class="st">&quot;white&quot;</span>, <span class="dt">high=</span><span class="st">&quot;firebrick4&quot;</span>) <span class="op">+</span></span>
<span id="cb13-20"><a href="ikaros-kobcat-gof-de.html#cb13-20"></a><span class="st">  </span><span class="kw">theme_bw</span>(<span class="dt">base_size =</span> <span class="dv">12</span>, <span class="dt">base_family =</span> <span class="st">&quot;Arial&quot;</span>) <span class="op">+</span></span>
<span id="cb13-21"><a href="ikaros-kobcat-gof-de.html#cb13-21"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb13-22"><a href="ikaros-kobcat-gof-de.html#cb13-22"></a>        <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>),</span>
<span id="cb13-23"><a href="ikaros-kobcat-gof-de.html#cb13-23"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>),</span>
<span id="cb13-24"><a href="ikaros-kobcat-gof-de.html#cb13-24"></a>        <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb13-25"><a href="ikaros-kobcat-gof-de.html#cb13-25"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="2020-09-29_IkKO_GOF_DE_files/figure-html/dr_gseasub_table-1.png" width="768" /></p>
</div>
<div id="gsea-plots" class="section level2">
<h2><span class="header-section-number">2.9</span> GSEA plots</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="ikaros-kobcat-gof-de.html#cb14-1"></a><span class="kw">source</span>(<span class="st">&quot;../../resources/fsea.R&quot;</span>)</span>
<span id="cb14-2"><a href="ikaros-kobcat-gof-de.html#cb14-2"></a><span class="kw">library</span>(rvg)</span>
<span id="cb14-3"><a href="ikaros-kobcat-gof-de.html#cb14-3"></a><span class="kw">library</span>(officer)</span>
<span id="cb14-4"><a href="ikaros-kobcat-gof-de.html#cb14-4"></a><span class="kw">library</span>(cowplot)</span>
<span id="cb14-5"><a href="ikaros-kobcat-gof-de.html#cb14-5"></a>ppt &lt;-<span class="st"> </span><span class="kw">read_pptx</span>()</span>
<span id="cb14-6"><a href="ikaros-kobcat-gof-de.html#cb14-6"></a>pl &lt;-<span class="st"> </span><span class="kw">lapply</span>(poi, <span class="cf">function</span>(path) {</span>
<span id="cb14-7"><a href="ikaros-kobcat-gof-de.html#cb14-7"></a>  pathplots &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">names</span>(gseres), <span class="cf">function</span>(contrast) {</span>
<span id="cb14-8"><a href="ikaros-kobcat-gof-de.html#cb14-8"></a>    <span class="kw">plot_fgsea</span>(gseres[[contrast]], gl[[contrast]], gs, path) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-9"><a href="ikaros-kobcat-gof-de.html#cb14-9"></a><span class="st">      </span><span class="kw">ggtitle</span>(contrast) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-10"><a href="ikaros-kobcat-gof-de.html#cb14-10"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))</span>
<span id="cb14-11"><a href="ikaros-kobcat-gof-de.html#cb14-11"></a>  })</span>
<span id="cb14-12"><a href="ikaros-kobcat-gof-de.html#cb14-12"></a>  title &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">draw_label</span>(path)</span>
<span id="cb14-13"><a href="ikaros-kobcat-gof-de.html#cb14-13"></a>  combined &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(<span class="dt">plotlist =</span> pathplots, <span class="dt">align =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb14-14"><a href="ikaros-kobcat-gof-de.html#cb14-14"></a>  p &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(title, combined, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="dv">1</span>))</span>
<span id="cb14-15"><a href="ikaros-kobcat-gof-de.html#cb14-15"></a>  <span class="kw">add_slide</span>(<span class="dt">x =</span> ppt, <span class="dt">layout =</span> <span class="st">&quot;Title and Content&quot;</span>, <span class="dt">master =</span> <span class="st">&quot;Office Theme&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-16"><a href="ikaros-kobcat-gof-de.html#cb14-16"></a><span class="st">    </span><span class="kw">ph_with</span>(<span class="dt">value =</span> <span class="kw">dml</span>(<span class="dt">ggobj =</span> p),</span>
<span id="cb14-17"><a href="ikaros-kobcat-gof-de.html#cb14-17"></a>            <span class="dt">location =</span> <span class="kw">ph_location</span>(<span class="dt">height =</span> <span class="fl">3.5</span>, <span class="dt">width =</span> <span class="dv">9</span>,</span>
<span id="cb14-18"><a href="ikaros-kobcat-gof-de.html#cb14-18"></a>                                   <span class="dt">left =</span> <span class="fl">0.25</span>, <span class="dt">top =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-19"><a href="ikaros-kobcat-gof-de.html#cb14-19"></a>            <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb14-20"><a href="ikaros-kobcat-gof-de.html#cb14-20"></a>  <span class="kw">return</span>(p)</span>
<span id="cb14-21"><a href="ikaros-kobcat-gof-de.html#cb14-21"></a>})</span>
<span id="cb14-22"><a href="ikaros-kobcat-gof-de.html#cb14-22"></a><span class="kw">names</span>(pl) &lt;-<span class="st"> </span>poi</span>
<span id="cb14-23"><a href="ikaros-kobcat-gof-de.html#cb14-23"></a><span class="kw">print</span>(ppt, <span class="dt">target=</span><span class="st">&quot;../img/IkKO_bcatGOF_DE_GSEAplots.2021-03-05.pptx&quot;</span>)</span>
<span id="cb14-24"><a href="ikaros-kobcat-gof-de.html#cb14-24"></a>pl<span class="op">$</span>HALLMARK_MYC_TARGETS_V1</span></code></pre></div>
<p><img src="2020-09-29_IkKO_GOF_DE_files/figure-html/dr_gseasub_plots-1.png" width="768" /></p>
<!-- ## Gene set heatmaps -->
<!-- ```{r} -->
<!-- # function to generate pptx -->
<!-- library(rvg) -->
<!-- library(officer) -->
<!-- gen_pptx <- function(plot, file, height = 5, width = 5, left = 1, top = 1) { -->
<!--   read_pptx() %>% -->
<!--     add_slide(layout = "Title and Content", master = "Office Theme") %>% -->
<!--     ph_with(value = dml(ggobj = plot), -->
<!--             location = ph_location(height = height, width = width, -->
<!--                                    left = left, top = top), -->
<!--             bg = "transparent") %>% -->
<!--     print(target = file) -->
<!-- } -->
<!-- # plots -->
<!-- myc_expr <- deanno %>% -->
<!--   dplyr::filter(padj_Cre_Ik_interaction < 1e-3 &  -->
<!--                 L2FC_Cre_Ik_interaction < -0.25 & -->
<!--                 L2FC_NTC_Cre_vs_NTC_ERT2 > 0.4 & -->
<!--                 !gene_symbol %in% c("Pdzd2","Sbk1","Gm5537")) %>% -->
<!--   arrange(-L2FC_Cre_Ik_interaction) -->
<!-- wtexpr <- myc_expr[, c(1,grep("^NTC_ERT2", colnames(deanno)), -->
<!--                             grep("^NTC_CreERT2", colnames(deanno)))] %>% -->
<!--   gather("sample","val",-1) %>% -->
<!--   group_by(gene_symbol) %>% -->
<!--   mutate(gene_symbol = factor(gene_symbol, levels=myc_expr$gene_symbol), -->
<!--          sample = factor(sample, levels = unique(sample)), -->
<!--          scaled = val - mean(val)) -->
<!-- ikexpr <- myc_expr[, c(1,grep("^IkKO_ERT2", colnames(deanno)), -->
<!--                             grep("^IkKO_CreERT2", colnames(deanno)))] %>% -->
<!--   gather("sample","val",-1) %>% -->
<!--   group_by(gene_symbol) %>% -->
<!--   mutate(gene_symbol = factor(gene_symbol, levels=myc_expr$gene_symbol), -->
<!--          sample = factor(sample, levels = unique(sample)), -->
<!--          scaled = val - mean(val)) -->
<!-- lims <- c(min(c(ikexpr$scaled, wtexpr$scaled)), -->
<!--           max(c(ikexpr$scaled, wtexpr$scaled))) -->
<!-- (a <- ggplot(wtexpr, aes(x = sample, y = gene_symbol, fill = scaled)) + -->
<!--   geom_tile() + -->
<!--   scale_y_discrete(expand=c(0,0)) + -->
<!--   scale_x_discrete(expand=c(0,0)) + -->
<!--   scale_fill_gradientn(colours = c("steelblue4","white","firebrick4"),  -->
<!--                        limits = lims) + -->
<!--   theme(panel.background = element_blank(), -->
<!--         panel.border = element_rect(color="black",fill=NA), -->
<!--         axis.title = element_blank(), -->
<!--         axis.ticks = element_blank(), -->
<!--         axis.text.x = element_text(angle=45,hjust=1))) -->
<!-- (b <- ggplot(ikexpr, aes(x = sample, y = gene_symbol, fill = scaled)) + -->
<!--     geom_tile() + -->
<!--     scale_y_discrete(expand=c(0,0)) + -->
<!--     scale_x_discrete(expand=c(0,0)) + -->
<!--     scale_fill_gradientn(colours = c("steelblue4","white","firebrick4"),  -->
<!--                          limits = lims) + -->
<!--     theme(panel.background = element_blank(), -->
<!--           panel.border = element_rect(color="black",fill=NA), -->
<!--           axis.title = element_blank(), -->
<!--           axis.ticks = element_blank(), -->
<!--           axis.text.x = element_text(angle=45,hjust=1))) -->
<!-- p <- cowplot::plot_grid(a,b, align="hv", nrow=1) -->
<!-- gen_pptx(p, "../img/IkKO_BcatGOF_pos_int_genes_heatmap.pptx") -->
<!-- ``` -->
</div>
<div id="downloads" class="section level2">
<h2><span class="header-section-number">2.10</span> Downloads</h2>
<ul>
<li><a href="../results/IkKO_bcatGOF_DE.2021-03-05.xlsx" download>Differential expression results</a> (xlsx).</li>
<li><a href="../results/IkKO_bcatGOF_DE_fullGSEA.2021-03-05.xlsx" download>Full GSEA results</a> for exploratory analysis (xlsx).</li>
<li><a href="../results/IkKO_bcatGOF_DE_subGSEA.2021-03-05.xlsx" download>GSEA subset</a> for stats on selected pathways (xlsx).</li>
<li><a href="../img/IkKO_bcatGOF_DE_GSEAplots.2021-03-05.pptx" download>GSEA plots</a> (vecotorised pptx).</li>
</ul>
</div>
<div id="session-info" class="section level2">
<h2><span class="header-section-number">2.11</span> Session info</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="ikaros-kobcat-gof-de.html#cb15-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.0.3 (2020-10-10)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] gdtools_0.2.3               cowplot_1.1.1              
##  [3] officer_0.3.16              rvg_0.2.5                  
##  [5] fgsea_1.16.0                msigdbr_7.2.1              
##  [7] EnsDb.Mmusculus.v79_2.99.0  ensembldb_2.14.0           
##  [9] AnnotationFilter_1.14.0     GenomicFeatures_1.42.1     
## [11] AnnotationDbi_1.52.0        DT_0.17                    
## [13] openxlsx_4.2.3              DESeq2_1.30.1              
## [15] SummarizedExperiment_1.20.0 Biobase_2.50.0             
## [17] MatrixGenerics_1.2.1        matrixStats_0.58.0         
## [19] GenomicRanges_1.42.0        GenomeInfoDb_1.26.2        
## [21] IRanges_2.24.1              S4Vectors_0.28.1           
## [23] BiocGenerics_0.36.0         tximport_1.18.0            
## [25] forcats_0.5.1               stringr_1.4.0              
## [27] dplyr_1.0.4                 purrr_0.3.4                
## [29] readr_1.4.0                 tidyr_1.1.3                
## [31] tibble_3.1.0                ggplot2_3.3.3              
## [33] tidyverse_1.3.0            
## 
## loaded via a namespace (and not attached):
##   [1] uuid_0.1-4               readxl_1.3.1             backports_1.2.1         
##   [4] fastmatch_1.1-0          BiocFileCache_1.14.0     systemfonts_1.0.1       
##   [7] lazyeval_0.2.2           splines_4.0.3            BiocParallel_1.24.1     
##  [10] crosstalk_1.1.1          digest_0.6.27            htmltools_0.5.1.1       
##  [13] fansi_0.4.2              magrittr_2.0.1           memoise_2.0.0           
##  [16] Biostrings_2.58.0        annotate_1.68.0          modelr_0.1.8            
##  [19] svglite_2.0.0            askpass_1.1              prettyunits_1.1.1       
##  [22] colorspace_2.0-0         blob_1.2.1               rvest_0.3.6             
##  [25] rappdirs_0.3.3           ggrepel_0.9.1            haven_2.3.1             
##  [28] xfun_0.21                crayon_1.4.1             RCurl_1.98-1.2          
##  [31] jsonlite_1.7.2           genefilter_1.72.1        survival_3.2-7          
##  [34] glue_1.4.2               kableExtra_1.3.4         gtable_0.3.0            
##  [37] zlibbioc_1.36.0          XVector_0.30.0           webshot_0.5.2           
##  [40] DelayedArray_0.16.2      scales_1.1.1             DBI_1.1.1               
##  [43] Rcpp_1.0.6               viridisLite_0.3.0        xtable_1.8-4            
##  [46] progress_1.2.2           bit_4.0.4                htmlwidgets_1.5.3       
##  [49] httr_1.4.2               RColorBrewer_1.1-2       ellipsis_0.3.1          
##  [52] pkgconfig_2.0.3          XML_3.99-0.5             farver_2.1.0            
##  [55] sass_0.3.1               dbplyr_2.1.0             locfit_1.5-9.4          
##  [58] utf8_1.1.4               tidyselect_1.1.0         labeling_0.4.2          
##  [61] rlang_0.4.10             munsell_0.5.0            cellranger_1.1.0        
##  [64] tools_4.0.3              cachem_1.0.4             cli_2.3.1               
##  [67] generics_0.1.0           RSQLite_2.2.3            broom_0.7.5             
##  [70] evaluate_0.14            fastmap_1.1.0            yaml_2.2.1              
##  [73] knitr_1.31               bit64_4.0.5              fs_1.5.0                
##  [76] zip_2.1.1                xml2_1.3.2               biomaRt_2.46.3          
##  [79] compiler_4.0.3           rstudioapi_0.13          curl_4.3                
##  [82] reprex_1.0.0             geneplotter_1.68.0       bslib_0.2.4             
##  [85] stringi_1.5.3            highr_0.8                lattice_0.20-41         
##  [88] ProtGenerics_1.22.0      Matrix_1.3-2             vctrs_0.3.6             
##  [91] pillar_1.5.0             lifecycle_1.0.0          jquerylib_0.1.3         
##  [94] data.table_1.14.0        bitops_1.0-6             rtracklayer_1.50.0      
##  [97] R6_2.5.0                 bookdown_0.21            gridExtra_2.3           
## [100] assertthat_0.2.1         openssl_1.4.3            withr_2.4.1             
## [103] GenomicAlignments_1.26.0 Rsamtools_2.6.0          GenomeInfoDbData_1.2.4  
## [106] hms_1.0.0                grid_4.0.3               rmarkdown_2.7           
## [109] lubridate_1.7.10</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ikaros-kobcat-gof-de-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

</body>

</html>
